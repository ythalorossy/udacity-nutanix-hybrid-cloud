{"status":{},"contains_secrets":true,"product_version":"3.0.0.1","spec":{"description":"Production 3-tier Web Application","resources":{"client_attrs":{"None":{"y":249.5242543044,"x":36.8952403805},"e429b102_deployment":{"y":145.4835911778,"x":126.0636681374},"03185f76_deployment":{"y":-161.5019891424,"x":-102.7927721011},"8d7a5c0b_deployment":{"y":-161.1771969117,"x":122.0849647415},"4e46245a_deployment":{"y":-149.7586147439,"x":355.7438380633}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"445785e9_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"86a105c6_runbook","main_task_local_reference":{"kind":"app_task","name":"445785e9_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"fb828d74_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"aa113063_runbook","main_task_local_reference":{"kind":"app_task","name":"fb828d74_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Restart"}],"name":"ff47f0bd_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"fa66a9e2_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"ac60fe4f_runbook","main_task_local_reference":{"kind":"app_task","name":"ff47f0bd_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"WebServer_Stop"}],"name":"a11b8543_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"WebServer_Stop","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl stop httpd\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"98fef3d7_runbook","main_task_local_reference":{"kind":"app_task","name":"a11b8543_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"WebServer_Restart"}],"name":"f214dae0_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"WebServer_Restart","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl restart httpd\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"fa66a9e2_runbook","main_task_local_reference":{"kind":"app_task","name":"f214dae0_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[{"kind":"app_service","name":"MySQL"}],"name":"WebServer","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"b2d7da13_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"dbbe6873_runbook","main_task_local_reference":{"kind":"app_task","name":"b2d7da13_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"bca79f09_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"f5e3cc48_runbook","main_task_local_reference":{"kind":"app_task","name":"bca79f09_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Restart"}],"name":"1ed67621_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"a5b1f46f_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"6ad336ea_runbook","main_task_local_reference":{"kind":"app_task","name":"1ed67621_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"HAProxy_Stop"}],"name":"5d9ab5c9_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Stop","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl stop haproxy\r\nsudo systemctl daemon-reload\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"48e7907c_runbook","main_task_local_reference":{"kind":"app_task","name":"5d9ab5c9_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"HAProxy_Restart"}],"name":"e7ac7d5a_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Restart","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl daemon-reload\r\nsudo systemctl restart haproxy\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"a5b1f46f_runbook","main_task_local_reference":{"kind":"app_task","name":"e7ac7d5a_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[{"kind":"app_service","name":"WebServer"},{"kind":"app_service","name":"WebServer2"}],"name":"HAProxy","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"4106c183_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"fe7b3f6d_runbook","main_task_local_reference":{"kind":"app_task","name":"4106c183_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"904da31e_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"279a8350_runbook","main_task_local_reference":{"kind":"app_task","name":"904da31e_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Restart"}],"name":"68b60125_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"507995ba_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"135ab4b7_runbook","main_task_local_reference":{"kind":"app_task","name":"68b60125_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"MySQL_Stop"}],"name":"a89dd3ba_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"MySQL_Stop","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl stop mysqld\r\n# sudo systemctl status mysqld.service\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"4cbddf9d_runbook","main_task_local_reference":{"kind":"app_task","name":"a89dd3ba_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"MySQL_Restart"}],"name":"f8a00a3a_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"MySQL_Restart","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl restart mysqld\r\n# sudo systemctl status mysqld.service\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"507995ba_runbook","main_task_local_reference":{"kind":"app_task","name":"f8a00a3a_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"MySQL","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"445785e9_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"86a105c6_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"445785e9_dag_cloned_1"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"fb828d74_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"aa113063_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"fb828d74_dag_cloned_1"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Restart2"}],"name":"ff47f0bd_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart2","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"fa66a9e2_runbook_cloned_0"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"ac60fe4f_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"ff47f0bd_dag_cloned_1"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"WebServer2_Stop"}],"name":"a11b8543_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"WebServer2_Stop","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl stop httpd\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"98fef3d7_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"a11b8543_dag_cloned_1"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"WebServer2_Restart"}],"name":"f214dae0_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"WebServer2_Restart","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl restart httpd\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"fa66a9e2_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"f214dae0_dag_cloned_1"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[{"kind":"app_service","name":"MySQL"}],"name":"WebServer2","port_list":[],"tier":"","variable_list":[],"description":""}],"substrate_definition_list":[{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"WebServerAHV"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"b3b9217a_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"5b00ccaa_runbook","main_task_local_reference":{"kind":"app_task","name":"b3b9217a_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"WebServerAHV"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"bdffec80_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"9e63a82d_runbook","main_task_local_reference":{"kind":"app_task","name":"bdffec80_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AHV_VM","name":"WebServerAHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"editables":{"readiness_probe":{"connection_type":true,"delay_secs":true,"connection_port":true,"timeout_secs":null},"create_spec":{"name":true,"resources":{"nic_list":{"0":{"subnet_reference":true}},"serial_port_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"boot_config":true,"disk_list":{"0":{"data_source_reference":true,"device_properties":{"disk_address":{"adapter_type":true},"device_type":true}}}}}},"os_type":"Linux","create_spec":{"name":"www@@{calm_array_index}@@-@@{calm_time}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"a32589a7-684e-4997-9454-d83aadcdaed0"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":1,"gpu_list":[],"memory_size_mib":1024,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\r\nusers:\r\n  - name: @@{teccadmin.username}@@\r\n    ssh-authorized-keys:\r\n      - @@{teccadmin.public_key}@@\r\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\r\n"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"d9d51111-4e4b-48c0-a3d7-6c3d78130d95","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_8_Cloud","uuid":"61a09121-e04e-495f-872e-5c6755451fae"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"HAProxyAHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"editables":{"readiness_probe":{"connection_type":true,"delay_secs":true,"connection_port":true,"timeout_secs":null},"create_spec":{"name":true,"resources":{"nic_list":{"0":{"subnet_reference":true}},"serial_port_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"boot_config":true,"disk_list":{"0":{"data_source_reference":true,"device_properties":{"disk_address":{"adapter_type":true},"device_type":true}}}}}},"os_type":"Linux","create_spec":{"name":"HAProxy-@@{calm_array_index}@@-@@{calm_time}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"a32589a7-684e-4997-9454-d83aadcdaed0"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":2,"num_sockets":1,"gpu_list":[],"memory_size_mib":1024,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\r\nusers:\r\n  - name: @@{teccadmin.username}@@\r\n    ssh-authorized-keys:\r\n      - @@{teccadmin.public_key}@@\r\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\r\n"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"d9d51111-4e4b-48c0-a3d7-6c3d78130d95","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_8_Cloud","uuid":"61a09121-e04e-495f-872e-5c6755451fae"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"MySQLAHV"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"POST_SUBNET_LIST"},{"kind":"app_task","name":"POST_CREATE_VLAN"},{"kind":"app_task","name":"POST_PROJECT_LIST"}],"name":"ca27d615_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"POST_SUBNET_LIST"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"POST_CREATE_VLAN"}},{"from_task_reference":{"kind":"app_task","name":"POST_CREATE_VLAN"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"POST_PROJECT_LIST"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_substrate","name":"MySQLAHV"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"POST_SUBNET_LIST","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""},{"status":"FAILURE","code":400,"type":""}],"request_body":"{}","headers":[],"url":"https:\/\/34.83.91.40:9440\/api\/nutanix\/v3\/subnets\/list","response_paths":{"CLUSTER_UUID":"$.entities[0].status.cluster_reference.uuid","CLUSTER_NAME":"$.entities[0].status.cluster_reference.name","DEF_SUB_NAME":"$.entities[0].status.name","DEF_SUB_UUID":"$.entities[0].metadata.uuid"},"retry_interval":1,"method":"POST","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"API_USER"}},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]},{"target_any_local_reference":{"kind":"app_substrate","name":"MySQLAHV"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"POST_CREATE_VLAN","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""},{"status":"FAILURE","code":400,"type":""}],"request_body":"{\r\n  \"spec\": {\r\n    \"description\": \"VLAN-@@{VLAN_ID}@@\",\r\n    \"resources\": {\r\n      \"subnet_type\": \"VLAN\",\r\n      \"vswitch_name\": \"br0\",\r\n      \"vlan_id\": @@{calm_int(VLAN_ID)}@@\r\n    },\r\n    \"cluster_reference\": {\r\n      \"kind\": \"cluster\",\r\n      \"name\": \"@@{CLUSTER_NAME}@@\",\r\n      \"uuid\": \"@@{CLUSTER_UUID}@@\"\r\n    },\r\n    \"name\": \"VLAN-@@{VLAN_ID}@@\"\r\n  },\r\n  \"api_version\": \"3.1.0\",\r\n  \"metadata\": {\r\n    \"kind\": \"subnet\",\r\n    \"spec_version\": 0,\r\n    \"spec_hash\": \"string\",\r\n    \"should_force_translate\": true,\r\n    \"name\": \"VLAN-@@{VLAN_ID}@@\"\r\n  }\r\n}","headers":[],"url":"https:\/\/34.83.91.40:9440\/api\/nutanix\/v3\/subnets","response_paths":{"VLAN_UUID":"$.metadata.uuid"},"retry_interval":1,"method":"POST","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"API_USER"}},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]},{"target_any_local_reference":{"kind":"app_substrate","name":"MySQLAHV"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"POST_PROJECT_LIST","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""},{"status":"FAILURE","code":400,"type":""}],"request_body":"{}","headers":[],"url":"https:\/\/34.83.91.40:9440\/api\/nutanix\/v3\/projects\/list","response_paths":{"PROJECT_NAME":"$.entities[0].metadata.project_reference.name","ACCOUNT_UUID":"$.entities[0].status.resources.account_reference_list.uuid","ACCOUNT_NAME":"$.entities[0].status.resources.account_reference_list.name","PROJECT_UUID":"$.entities[0].metadata.project_reference.uuid"},"retry_interval":1,"method":"POST","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"API_USER"}},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]}],"description":"","name":"6e2d3204_runbook","main_task_local_reference":{"kind":"app_task","name":"ca27d615_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"MySQLAHV"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"87ecf86d_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"03d126f6_runbook","main_task_local_reference":{"kind":"app_task","name":"87ecf86d_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AHV_VM","name":"MySQLAHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"editables":{"readiness_probe":{"connection_type":true,"delay_secs":true,"connection_port":true,"timeout_secs":null},"create_spec":{"name":true,"resources":{"nic_list":{"0":{"subnet_reference":true}},"disk_list":{"0":{"data_source_reference":true,"device_properties":{"disk_address":{"adapter_type":true},"device_type":true}}},"memory_size_mib":true,"boot_config":true,"serial_port_list":{}}}},"os_type":"Linux","create_spec":{"name":"MYSQL-@@{calm_time}@@-@@{calm_time}@@ ","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"a32589a7-684e-4997-9454-d83aadcdaed0"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":1,"gpu_list":[],"memory_size_mib":1024,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\r\nusers:\r\n  - name: @@{teccdba.username}@@\r\n    ssh-authorized-keys:\r\n      - @@{teccdba.public_key}@@\r\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\r\n"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"d9d51111-4e4b-48c0-a3d7-6c3d78130d95","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_8_Cloud","uuid":"61a09121-e04e-495f-872e-5c6755451fae"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"WebServerAHV2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"b3b9217a_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"5b00ccaa_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"b3b9217a_dag_cloned_1"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"WebServerAHV2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"bdffec80_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"9e63a82d_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"bdffec80_dag_cloned_1"},"variable_list":[]},"name":"post_action_delete"}],"type":"AHV_VM","name":"WebServerAHV2","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"editables":{"readiness_probe":{"connection_type":true,"delay_secs":true,"connection_port":true,"timeout_secs":null},"create_spec":{"name":true,"resources":{"nic_list":{"0":{"subnet_reference":true}},"serial_port_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"boot_config":true,"disk_list":{"0":{"data_source_reference":true,"device_properties":{"disk_address":{"adapter_type":true},"device_type":true}}}}}},"os_type":"Linux","create_spec":{"name":"WebServer2-@@{calm_array_index}@@-@@{calm_time}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"a32589a7-684e-4997-9454-d83aadcdaed0"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":1,"gpu_list":[],"memory_size_mib":1024,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\r\nusers:\r\n  - name: @@{teccadmin.username}@@\r\n    ssh-authorized-keys:\r\n      - @@{teccadmin.public_key}@@\r\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\r\n"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"d9d51111-4e4b-48c0-a3d7-6c3d78130d95","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_8_Cloud","uuid":"61a09121-e04e-495f-872e-5c6755451fae"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]}],"credential_definition_list":[{"username":"teccadmin","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"msbUu5MEDufB+Q4ntq50htWLrDCdOYHTkI5vlRRAUHjlE+b5+RpP2NNB8JAF9mjCkEJ\/NSIte3htWTIgeOmUJw05Lci2+m0gajdjcy1sRlBbfj+X8LUGQb+z0YXsD37ve5ckEOrwgqyp5U4Y0Zt7r9sVXVfBjjfDdXP2XbA+bAIqRrlWgOT8kQF7XyX8OaeapT2O1I9XR+qTjoEYO0NJYfzaF6KqppJzG8mUKvzXvbrIQtV5QUcdUgEJ687hTxWXo3zfKmIJhGXgmtVOm0YThUelcctaB5kUBCyRhAy05CCR0ntenH8hU5mZpWbogep5mvFVBLsCXF7VX4RgfpU2bQw4Qm9ERMzkIrPTW89TSk8AA1kuZPNFVwcHy4psm5Sie07jI3ev9KBrpxRy5laWykHvUXwTEgo3HssmsQ6ykHaIRP5x5fd6+ahPlt1vyLG1C8YE5oYyX9UmPl3ts8qnVKJlGhLQ7k977Zr2QbQ8Z4Bt5NJ2\/r4REnex\/9Z1CQyRFcFvOE5H1HAr7mvMNTjXnELHdJDOEuX\/he61QKpopUjmaCMZ\/7d06KRl8Cfmdp5ULBZUqVuPB7Ss6cZtzenomRqK5hjg0SdIgMMoL106mBW\/PkPZG2wpEWXwtHw4Q5I8nVIwgJB3WcxPHxmvDvhhPF5gbmB4x9H6ghAl8\/zWwv5BPTPoWLHk9Nutdxl\/OkdO97uVl6gGw4Rwg4sQe5aMsxafoMkhkoBGirreJsgrQDr4\/xmJHMRN428SgqtgY57mwbUCuTpkpShkqa9n2bCSIEW2d19l0LicJqR51SSj90bPvsaD3cyEmUchczhEzVIANPGY5YDTNdPjJS4ymks1UJZjtNXt5ufFESQqO1fTrIFc5Z4otFGS3bAIOKd7xjProY9LrSGfBpMoF6fePoPM2faWECBiUTypoAwcRzTqDbF8L5Tq3CbR2WNpnjXetrKL6BDEva+0GQK5BODCLll2nSZVwcYUI1sE7vNSpu08Jy6LvyvV4MRO3LQ6fRBmW0WtQsi8ASZypx2E69C2Px2SIlx03qpluahgzKb98uhvPf3YtDH7VG9ysROQOUpbHxnEXAOA1UfM5p9VkFB4YQWRsOBW+53mafoh3lWzy\/cIqZG6ZeIya2I+PsJvOvVGYckMgLfbIQX4MMIfpJgRCkOwrYRxRULlEL+CFcxdvIiU4eJLKY2PoyEl+G5AqCttFSkl8KYp1JWTjA5zdq+WIyaNlfVKjIdBHg6+EHhO98XAhZDJ9ffV\/nQGe9twGFck7KhG\/2FnCYhPy5Ju8l0+geo\/El02QGzqqxQ3ftislA1CLIf48Hl+I4S3+eZoAnvLnvuDNgzv\/poqBagdfOnGPS2SkjpDmnpRN3zrVGW7AzACQzXkVeJx8gclfPm2TxZ+QHbR2c38CXgs\/BlIXETczxci\/yCKKu4KYqSWtEWqpg71hPzQCt\/pVxJgYu3zPSDIs2IJ0BXM86Yea817xztjtOd6vGui2tVcO\/6TPOKekiiqZU2ehHVElu2nHUT7RaBr4t0bB2ypJB3765DXNjpsfR8PQWMc2\/CwX7OTu7EcT\/vap0cA7RztSSnL\/fEHRZs+ztBUEaEIhY6kmN82zHn1Qprzry1mNrWYF3nOoACW5PtotM+gvYJRhnnOFSiN6MudIXXmsE5VDOP8iqhGZz2YdVoQYiBOtcTmZ1dQyhfnupikKb3wWVjQ7UB6hM8pq2I6aG3y3jHEWq4nN4RmJZyB\/j\/7MC7TSh1axwYhySt70w3T5cshMIFSe2c0fpIdt9VDkewVYl0KSiV7YfpVivxzFTGYuWn87dswMmcazgi1ruhUAu\/4shFdxQMWkiypGczRJ9aVgpQ50U8ub6ocuTmJSFKpaad2I5e9z2ylKEsdk7izJgyTxZWxJwfb8PjiWRrF7vQldzkaSDP\/pIO38RoHJ+mKKoNw00MNNgbSKF0AUjlWhRvPaBajtEyGfyRw84HYe1juuW8254CyOdv\/DZ7D79ZMPs48cWb3TYAAXcH2clZqIq\/0v6Iv2602f3Zh1la0EcMSrb9ZuuqHXo1D1y\/i0autXpJ90TBFK4xJRO3PmoTKQDeS16vF4BMT9KLcqO0xuwTKaGF2++7GJV1a+U80Ix+twbV50ADbW\/7WEHCIbQwXx1SKW184QTg0XxrdhtNJEZhWxq1+lUAoQVS+ENB5QxDILs24ZLw7xPUrnntDtn+r1+C1NarfiOoJvtPj0DBT5HOraOGnZ2sK0UAqNtcHsdDaDbapOPZLEp26oCOGeBYv3IbMtz2Pq1rz2Q+fuimyBTEgVhYtRV3\/wtA8\/QV2fMN6Gx0ZNRkcWujQBpgwdOlwGNKIv7ax6MsI+B65LAwzMsJOAm537UbpRAEtdS0vF9kX1hQbByO3\/7gYeHkeJAVhVSjHQqlszZFfW1CegSBDMf\/AHJMEixOMKO4ohfgPQjfDj7zcx0dG1SAIxUpvLhDuXz+TPUZO\/UPriumc9mXJj02PpwFQ3rzkxHs+1ogUnCyc83VMr5nfgc+1yiPuGpgPXCRrour0hlEi92Ez4Mmy52+w7fkmcEHNR+tlbH18rS0r9aeHtlcTsYUScUbaE2gZXUOac6hweAE1UtGG7x9tCpZGDlMSReTSCOzsDnZ7oLla8mQLOKeJGrDehmM7EBznuuYkHWf5yCjNf8f3RjGsZ\/eJVGwveXLJHsDtwL9X5ANu0I5JWpVFlwYIRkiqvE0x7XppEJiiDy5q6UHUcn8YHwvTbNOnA8gdBe1d5VrCmAIBtuvz4uJPHvlRpQlaUeBJrmfvlGzBAFQ94jOvWTigUfqc6g3ZFpvgReozAd0JOfxi4nlGvJ5qfwJJ\/6G8VPyau2Y6HVG7tRfzCYmxviQ0hyNj2A6fGhJIRHERfi5DiZba9T0nDM4ycLNNBBxMP6T9g6d\/Q5xuqLamnMvHUTBSheh+h9uy5OD7ujZ2EMU7Uklx6v62v\/0zjd9vuxpFbZqXMMoYqjE37zoHW1GaLoDYS9vWeGkm4lB9XC3fzeRaJfrUtkuphQ\/SpRNoexP7SPMnJtsu9HvBVaZBqY90sdvyEezPwTrMbVgJsZnJYBVetrsqeKWw9FZKY2yOHr7lQdMCbfjD9EBHflNIXmQEpoG3YTM3E\/N4EAHdZ5qFdbMvw23cCgkn0M\/4A3YUs7gn9n2ejg2VV2CmVIh2PhXP3bQHU+3ofEYM1cl\/BySppeO7dHBOxJqpuEDLs\/NFR8KmeKX5hUesRlzVUb+HSH0b4OzaUYoOp0GimGNgjdCG\/NhfomK4xG3Wl0D6ndRXdnIiZzcpIIgXTaBcAIqR:utf-8"},"name":"teccadmin"},{"username":"teccdba","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"xmYG6fGxSXXTlmKxeie\/\/XVPfVqzuVmhhNuhNMLueqC8XBtMpVNe++hs4\/V6Jij5O6X7yGXmdmwbVzh\/JK0dFHf+J400fV4cmN+MaB1JYFQUsFdAMn9abF8IOy58OX4wLhdjJrRgMqUsUqzuzdPpNJPjA3pOOO5wclufHZq9w8AJ66EJnuKsX3m0HIu1wc9RpqbMru3oEIL5f\/tjz7nIQ7DejsYaIOn1MWlNQJJN4sHTdOOvDeC1vMrNgKfyxIrvNZoM6UMHMA4JJeHscA+LfofwMCNR4DLmVs4U8shEcIgDpQ4wxH2Mb5wMPTpU4zneBQrzUJfQKJTCkaVax7p21huKB5duT9p9uHVYbX+8\/R0iKGaNEkT5Abg98Rw4nwEQnTPUr9uj4qUAYd\/hlFci7FCZLPGyUBmM5Au1C2sd60W8PK9cHGh7My8zfV0dXDiXx+0axnsnSYNStHMY+FCfPAJ817Ze4W62eW4ir4agzD6WBhtEhYUTe\/wEHrDYRJmAvau9GTpiPsSGl6YomMaJzcwqm8EwAhUPPNG+gU+YpN4ktkvOost3mKD8VBtifQF3f4I0SRCe1PK4LtFYTp9N0CWd57IQuGe2h2IsuP9UrDYKo6mpCM+qCPFZ+xRdvD18jrSmqx4cAfvzsSHIQdFkQeRU0KMlp1lLcLRyGoiJ5v+gay+Ncazd26fOvYjrcgH02zAXKXzBY5eTPi\/jVu9Hja+1RIE5fhoUtTplx5F4botIYdsctfL42Ls2rzutovkjJRJsIjnwmcXL40zhCpJAnWr0LfpTnAEhzW+yukVXoKy0r1h4\/mkOuUMJgRkWgl0QGBQmi8bCLl\/9V6fOCO7ZRaeHJo5vsRmub2eZwBZXHH3ok09fG5gHrpPd4ceT\/aYkrEAXUrK5EGwkQaWva+yNVThH2Wur17RX+DbyTjg03O9kKmhoopHPuUuhHAvCpf3aUOUf+gfMst4KC4fvT7VA1caNGL5vA7l5TK1w9h8UBdqr83judcJeCRDZw8ODprC7KrdFXt6C3oqRalwublTHH49mGM29DiryIoUaMau+eOWlhoz1OYt18PBAM5PJ7ccjEwH1\/SfomZInGt42tfDDXYM57vFAUkxHoumXLVEhgfPARTXWqrgEK9TUPYdMYDbX6DwNJbXgS1bhyNfOgrXnR+V\/rpbcmxUiXxm3TmXBxM9Gxeomokg7Ovqg7uC7X64pf7r\/ppzxIcqiV1m6CIkXCR7NbhPuTJBdzgBF9FOXSPJzVmyshUJW0E1PlAaLcggLJdAFKo+ns3KFfP035dRkmlPVQFH+Gtyw0Y3NR\/lhONUMinuQz11RYguLWZCiFzvzAq3cU46WQlNb+9x9Qc3EJHPVfI83B9mKrFFhLE\/+jpqMgK5C0zapAz83EYY3POt1lk0quuE4Tdr5dvxG6p57XZmUHp1vjewRvf2ZWfKzGnhsm6jYE5drNqxqUVCKgAVZnU+3vGuk\/edTB98IovtGmBSNdN50iDZCz7LwdMMBIsT1sOju6YQHwQq629LfEj+gab\/GuzTv7xSiy80H\/ci\/z0bEcZnAZ0Ic56jMlTUqSwtN9cLyH\/EbsmKiHUmw1uQN+C\/469mXhGW6Sdt++dRIiAO1dnh88f0kO76le8R+Ev3re+ARXtObnFnM5kYY7+IPtoFbQWhJ3BN98wKnzIXdyglwj4WJCOotlb08HymzQ1pRiwvZm4E5wG2Jk\/E\/UU7V45yb+P02Q+d7N7Srt0yoG1EkXL1uW9a5TkLCtduAp+wn85oibLuI7jYR5d\/ilffoRGez6jhSsXoH1SLUcySmKuPqFMGg1rGelfvNwPi6HxUlZs7p1kkmNajKz1RNyZNq5PkfKDDWiCr9JgdtWHmSGs5X9V2r3EeB9uyPEEF25s1buc+3xURTVnghOfqJk3UrL2oaKfgprYZhFwTDF+nIKMfQHTfthPkP84wj6AKmxaNiPZRqTq\/vabo9nVctluKLuNwRcaC5Odzgk3QS8gehPdmgXAWnyB58udh7iTVzfdCmntLzscyLqSBa0lcf\/2bMQlf5MOtkRV\/yF9XORKdOey8+KuhHr85kCwsWaZ3z\/fnD4PG4UzWS8l6+XjSI0Xp5PjZDiDYZdpmurokrJovU+FS9YiuTzucwM8jJXqezU5hIchwWo8eAxOLvvoYLnU94jKSDVDiyNba65tXA5yKCVp6yoc+Z6HaGNIhTskG\/7w7N+2+vwyKcFTSsyTdRopmXSGpKkJpBZCQf8C+35Y8S+v6FX\/q8pkCk5n4fme6i5S\/+hnYzzZBcLjkJRYCtBz71VlBaHfi7\/5D\/B2tg1XRyfGVg00En6Oud0tzyR8bElv3m5EBo6ge6ndzjhXu81kaN+mf7\/OeRYgr0hYnWNrwe+47XXh\/JD5HCg76vorjhPcT5sE1mVb01ttTRntmxCEPXgT80YXb3ZR\/hAy\/IEboYpDOb\/IJ605SegkMJ2zcpvJcpkx8ZezvhhfMzuMTsn+PD5uB4dtasocY7DDFF2p3hyg8MfNupMtPQRwjtiS8l2lrB8Pk\/QQ4dEbpk9FMLJUCaEy8gwk2qMiOwSkX0JCofOCeVmTVkhQaeX8wyOzkHTpHt55gXN8yj8dkW3xT28N\/YbErFEHHR6+YvrdPVK98Rf3HJV7G\/FgqrqhbPT9pSIz9yUqpZtLjf+2zfGEbsa8TRpUmC26oPQ8DlJywwAOjs3NmS1eh9lIRmfe0W47Ja\/LBM3o\/60pojtP94GijD9w1MqPHmxHfqdRhnSF8Ezo\/TOtuTrgd5jxygOxSYnLq8KL\/hsWqJLmq6TT9rxfZbQPv3+X2Q5sJtAaZRGUNVo434sniB2Ab9o71Fy+Zwfj+c5jICywXEmRUGoFHggyfj83FBqAkWuc3\/HRBfCi0TZ5nlcrPlSvptQgcgwOkszBNuLyq16hdAv2RC8yR6WCkIUncsROgmf7cv5rnoR1PRJPXi93s5QfQlsureZcU03QB2wX71l5rthEv+sYX6754C07ePIdZ2dCrzb+CeQDzfRjsIDEDU8OGk9JIaCuI\/kYJPO\/1PHYp\/cOyLFMp0J1tQmSdcwcg2Zq3pLDvjr9TjhT7Qmd79qyiI4UEPh+bKW2pG7MgMYPhx15S\/PR1PoYkxJi\/GBrnT++GQcbeHe73lympcuj4wxAzbWUsWrrEtFLo3A5RxfLx2XlLUH2iEt5aObKCRITpCV8uqi6olVSKQ9WiN62xwYZX6\/QPGT3JF5GjBrM1k7WsxkU7qzcA4jcoLzQJA2RSc\/ccdI9OD3I75qTZV8zkddyg5\/DNyLDViIJpBcpV9U9d8dNhc:utf-8"},"name":"teccdba"},{"username":"superuser","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"8lQWjN+OgdvfGQ0nWrFNNKKdSYr1JwjhfIoPcpzJ8TAJZbgOuPIYRirfOrTfWT+VN5jk7c7thATKJVQvgCLo\/QUD2OFWLte1yRV7sVb\/wyJL0biXkY2UOqzAkS9VgX5V389XKKiaWFTXJ9czMLZ3Ov9aRPnEQeMUMXwE\/pO0RlRwYRLWx5wW7eBvMEsxfOKndxtuEEu3ZCH938ZNj9A\/PuJEUkDfSXFCn\/LXUCH2O4zpVV9X2FjzPbUn3ti+zG3PF3V9wFCkLn+yLaQFoIdysq6JyGdGOuwY46T+SAzFgysv7FO8Zm\/kLCr8jjRBc9mNT\/SISGuwqVFCL2zGdGCdsugK8CRo3VjUoj2WPWn5AkIs3QO62vvnU8a3htm4teH+23uGB91JSbWUQyDOXCXcAin9YSROl5Ic5V8DfZeDncN9LaKa3WdQ+3UI9rEsfheaTWNe\/9jGiZSUPlD8e4Y7i0SxmZkr7ra\/NFAWWum8yNbjM9kUXU60MMzhpo9jSJnnJAMaUus3NzT6f6QimLbnTgYYgODeONycWRXtWcLpRMiNcHS3xrmJ6r0WZc9sMtIDw6J2z5rVnGUwKwsLHAR161vfZCYJpgm\/EalpN3j\/NLFSsr\/dJq6Wqym5zucv3mlmGiLNVNliXNINAFrCuGlusWIRBxcCjzHwSXNinmJg9laLclfecwLvWopdF1yKOJ1gQ8+Iy+B\/NsJNLpk3yUC7WWr7fbxU61qswG+kKP2ciRIuiN0k\/y8j6Nq85s9LLXbC\/6JNABRYq13nd9NoKauuE2nASnfgw5RJUgHQ0aCmGCfNd2kcaThCXhUk+17K4YmUJK2RXHR0589EiqAtUm18SHiQwYchwxijvIrluuNfoXgUzibPzzZla8orhwacDvwekYm1QVVieMv8XGepjbSTEKnk9lPZb7xeI0EGnj25PJ7oGQ7SXXPs\/wkxK2kgkEYF8AHu5rJ3A1jzTtGqgNPs6MDEeJ3QGA45EWmrinsZ2VBJXCZVzz8iNm\/OSBWSeV3GD614Rhgacr3VX9ugdcpQ2FeH5RuSNO\/VlMSNCTTve0BDx4625iV5WFV58YWUAWf8yE1pdPW\/e4pqXrN6eom0bqp6sZTg7a+pnUPXP\/QVJVPN5QKamvUQ83max2SL67uomzQtKCW0Rej0smZobxDs76vd7Q5yntUwanCMt3CXqBWXZcx0GYGzpdtrH2kz+aaciCUZzjnRalcqYix9PJS\/PNuSztkdb4JYgB9IFMiMXzFZEFx8kWRveN0zcPF86mghSFM0b5SgJkJYWGUSGXlnHOl7DFX\/UFm9\/Z3wI9TwXAZmV+De0+5Q1du8wrrMD4L3Y8SGTjACn8xHL5+ZwhAavTLQ6Kpj67LI4QdJBUBhnbwgZYCCegKugfd3hd\/RLyrf6WKaTMYP13u2EnMJ3rUKgyP1gEc00d2rEaDywQJVXYmg1g4JBjvkFjrUALf3BPG1xL3j6utxAcebyS9xYpYBughe2B+1pVK+z8V5pRXkEA7ZpTlCoPVyUn0oPeu81FlcYvy5JhViHo4DMizSIYG\/a+vogTC9tqUivucVpnLNAbaf6LoizFqgQi1QZyN8u5JnaraySWfKJxEwj4RPr4XJ+sn14GuW2GRX2Bui9NfUCG68p1UYV60yeHX3CT5T7Bm60WwIqj42jehPS4d3vfH7F0PcidnC1S+dWKxPZTlT3Oj3\/MXGDvS0ASWw9nnuJImNWxlfRzQKUa3PfLsPK6KuU6+PTreMitD2sLgfSYlpF9fUDw7+YKEm5SNNsLIyO6K8g6d4QjpPQQw3Fr97sVU2zaj2RoaIR4Fyba4z7pDDDsKHufKNx7a0zJi1TSSfysQuERmeqV\/ELVwkxP9VkCsmAdKfG++kol5id8PuO9WsIJB5dQXXY\/gGHDKK0yLplc9HFQojcBiz70AH2zTIfH8s2AzS669pYSbPHPXVpvQTTC8yl8wOggecQWy3W9nSXPLQHlw1PBy6af2LgjzrDjEV2qEjsQfVvhE4OJf+56Mm0uiYIKx4c3hGo0QYmrd7CDHQtdy1qRrvXFzgmL2mTvedt2gNcGcUPnSbLYjrFNmdVzqI2qVkrJ1FcIf046k4ZtEz14R8ozS74tGL9ggNV8lIHsXrIyy5Obth9K71GDfP+zSj+iCLGVSNyW2fIR0zvsKONP00HwxjMEI447QJmloZTbLGwyYZr8\/Bd8zyFopxVWclp3DxJ39x9M6YnL+xIiLcQ3UX3PcI3Zh0KzFBMW19v5wnvjjuuNLk7YGf1WjHFXwB\/BKU6cyBUma3J8Yhqo4GjozW926DrXNDH\/E40Z7gorm3ZqyrTqhzHu4PizONvc3KGpXpP2ei9Amw5N3MLJ6mOEP91mmBUisVQlOWoGQteiDGxrng005gtPKIuPtBB+W0FtaYh8XcQeh21ICg71sJ9vW0pbE1Ygwuvzo0UyBGUtEQlw5\/evRyylPIFf4N7BevIyuo3AB1aR\/sCQL334BljxXcPTkr1N73cgVl+4wRO5zlhgVnUTKj99n+RLaxXO4bYn\/xQCsypBm8E0jj1VjSZkdltdcWEMXlNB\/PgpdMVx5Puyvo7OSqtmWH4DfCv33vJFJbDH8j5WfHa7GA6SKKL+yTOJFJMaa8WoMQ3Sgz16DyMKhktb5FTuR3P5SlCQBSuPYcoZXtyPFwqsvn5WCh7CQnEMa3qqWFcaJGu+d2P+eatXmqLXg9mkp+gbCzX54xCGx0ddeyOgjEGL4ry0QIhBcc16XuVOg7zUD5nkc2JtSlByLh5Qm9JXAQOQRBsdx3IX6TyrmSms1cI5YNCSzPaRvjBLNVNNWQfISgH6YFnXhCqELL4hYtRVC\/6j2Sp5QVH2fA22OBMh6vlbtOk\/KbNSfpyNj+D66n6cBXt1TWel+aSpA5FrRbF7LDyiAR4RAjPrzH9dl37cgZSRAa41yxuKEH5m3506pIHUJ8S+jfCfWU28b4IR6NnbyZJWa9eS0BEocHyZTjFh4jfI9NVug+wkJXGOo7+8QhAVEqqHBYRvJ2N+kksspBOr0jjMs8KXSrAOcL95b3mur5LoCmM0SDL2TSZwrlZ5cOOdNcZF4RFhxR\/plGQdAgMqrC5194fU\/rLRn+PyBxlHWDdDCndVG+u6DErA97eRQNIBTlnBfVKBS9pWMQEQ8VbatjgQhueH4zXdXkmMIYi8PAwUz7DlvjSyu4VsRXQj8otrz1myrhupK567miSFKYFf8FaXbkw6SRSx8Sbitrz9zFwE83yz52ZDqapBt3ombNhM4CGhZtcYqOo+NayQZpSmRv8nqaS\/symYaeMpvm:utf-8"},"name":"superuser"},{"username":"admin","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"2xq4nxlYIK11HeB36O+5Z2ovVAadC4aDDO\/tSg2mDb\/1MwbmQWFpcd8=:utf-8"},"name":"API_USER"}],"package_definition_list":[{"description":"CentOS 8 Cloud Image","action_list":[],"type":"SUBSTRATE_IMAGE","service_local_reference_list":[],"name":"CentOS_8_Cloud","version":"","options":{"type":"","name":"CentOS_8_Cloud","resources":{"image_type":"DISK_IMAGE","checksum":{"checksum_algorithm":"","type":"","checksum_value":""},"source_uri":"https:\/\/cloud.centos.org\/centos\/8\/x86_64\/images\/CentOS-8-GenericCloud-8.2.2004-20200611.2.x86_64.qcow2","version":{"product_version":"8","type":"","product_name":"CentOS"},"architecture":"X86_64","type":""},"description":""},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"WebServer"}],"name":"Package2","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package2"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Linux_OS_Update"},{"kind":"app_task","name":"Install_WebServer"},{"kind":"app_task","name":"3Tier_Webapp"}],"name":"a0484eda_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Linux_OS_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install_WebServer"}},{"from_task_reference":{"kind":"app_task","name":"Install_WebServer"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"3Tier_Webapp"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Linux_OS_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo yum -y update\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Install_WebServer","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\necho \"__ Install httpd and php...\"\r\nsudo yum install -y httpd\r\nsudo yum install -y php php-gd php-mbstring php-pdo php-mysqlnd\r\n\r\necho \"<IfModule mod_dir.c>\r\n        DirectoryIndex index.php index.html\r\n<\/IfModule>\" | sudo tee \/etc\/httpd\/conf.modules.d\/dir.conf\r\n\r\necho \"<?php\r\nphpinfo();\r\n?>\" | sudo tee \/var\/www\/html\/index.php\r\n\r\nsudo systemctl enable httpd\r\n\r\n# temporarily disable SELinux to prevent httpd to MySQL authentication issues\r\n# this is for testing only and should not be done in production environments\r\necho \"__ Temporarily disable SELinux...\"\r\nsudo setenforce 0\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"3Tier_Webapp","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\nsudo touch \/var\/www\/html\/index.php\nsudo chown @@{teccadmin.username}@@:@@{teccadmin.username}@@ \/var\/www\/html\/index.php\n\ncat > \/var\/www\/html\/index.php <<- \"EOF\"\n<html>\n<head>\n  <title>@@{calm_blueprint_name}@@<\/title>\n<\/head>\n<body>\n <h1>Hostname: @@{name}@@ at @@{address}@@, replica: @@{calm_array_index}@@<\/h1>\n<?php\ntry {\n  $dbh = new PDO('mysql:host=@@{MySQL.address}@@;dbname=@@{DATABASE_NAME}@@', '@@{MYSQL_APP_USER}@@', '@@{MYSQL_PASSWORD}@@', array(\n    PDO::ATTR_PERSISTENT => true,\n    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,\n  ));\n\n  \/\/ ensure there is at least 1 row of data for the app to read\n  $data = $dbh->query(\"INSERT INTO @@{DATABASE_TABLE}@@ (id, time, message) VALUES (NULL, CURRENT_TIMESTAMP, '@@{calm_username}@@')\");\n\n  $data = $dbh->query('SELECT MAX(id) AS count FROM @@{DATABASE_TABLE}@@')->fetchAll(PDO::FETCH_COLUMN);\n  $count = $data[0]; \/\/print_r($data);\n  $data = $dbh->query(\"SELECT time, message FROM @@{DATABASE_TABLE}@@ WHERE id = $count\")->fetchAll(PDO::FETCH_ASSOC);\n  $time = $data[0]['time'];\n  $message = $data[0]['message'];\n\n  echo \"<p>Database records: $count<\/p>\\n\";\n  echo \"<p>Last maintainer: $message, on: $time<\/p>\\n\";\n  echo \"<h3>Web docroot: {$_SERVER[\"DOCUMENT_ROOT\"]}, file: {$_SERVER[\"SCRIPT_NAME\"]}<\/h3>\\n\";\n\n  $dbh = null;\n}\ncatch (PDOException $e) {\n  print \"Error!: \" . $e->getMessage() . \"<br\/>\";\n  print phpinfo();\n  die();\n}\n?><\/body>\n<\/html>\nEOF\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"4a161ce1_runbook","main_task_local_reference":{"kind":"app_task","name":"a0484eda_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package2"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_WebServer"}],"name":"9ab78648_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_WebServer","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\nsudo rm -rf \/var\/www\/html\/* || true\r\nsudo yum erase -y httpd php || true\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"e96f5315_runbook","main_task_local_reference":{"kind":"app_task","name":"9ab78648_dag"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"HAProxy"}],"name":"Package3","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package3"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Linux_OS_Update"},{"kind":"app_task","name":"HAProxy_Install"}],"name":"4a731e9d_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Linux_OS_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"HAProxy_Install"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Linux_OS_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo yum -y update\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Install","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\necho \"__ HAProxy installation...\"\r\nsudo yum install -y haproxy &&\r\n  sudo systemctl enable haproxy || true # idempotent\r\nhaproxy -v\r\n\r\necho \"__ HAProxy configuration...\"\r\n# http:\/\/cbonte.github.io\/haproxy-dconv\/1.8\/configuration.html#4\r\nport=80\r\n\r\necho \"global\r\n  log 127.0.0.1 local0\r\n  log 127.0.0.1 local1 notice\r\n  maxconn 4096\r\n  quiet\r\n  user haproxy\r\n  group haproxy\r\ndefaults\r\n  log global\r\n  mode http\r\n  retries 3\r\n  timeout client 50s\r\n  timeout connect 5s\r\n  timeout server 50s\r\n  option dontlognull\r\n  option httplog\r\n  option redispatch\r\n  balance  roundrobin\r\n# Set up application listeners here.\r\nlisten stats\r\n  bind *:8080\r\n  mode http\r\n  log global\r\n  stats enable\r\n  stats hide-version\r\n  stats refresh 30s\r\n  stats show-node\r\n  stats uri \/stats\r\n#listen admin\r\n#  bind 127.0.0.1:22002\r\n#  mode http\r\n#  stats uri \/\r\nfrontend http\r\n  bind *:${port}\r\n  maxconn 2000\r\n  default_backend servers-http\r\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\r\n\r\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\r\n\r\nhosts=$(echo \"@@{WebServer.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\r\nfor host in $hosts; do\r\n  echo  \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\r\ndone\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"3c8b5180_runbook","main_task_local_reference":{"kind":"app_task","name":"4a731e9d_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package3"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_HAProxy"}],"name":"f61300e6_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_HAProxy","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo yum -y erase haproxy\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"0f94a6b6_runbook","main_task_local_reference":{"kind":"app_task","name":"f61300e6_dag"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"MySQL"}],"name":"MySQL_Package","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"MySQL_Package"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Linux_OS_Update"},{"kind":"app_task","name":"MySQL_Install"}],"name":"7575a53f_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Linux_OS_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"MySQL_Install"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Linux_OS_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo yum -y update\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"MySQL_Install","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\n# Assuming CentOS\/RedHat 8.2\necho \"__ Mysql installation...\"\n# https:\/\/dev.mysql.com\/doc\/refman\/8.0\/en\/linux-installation-yum-repo.html\n\nsudo yum install -y \"http:\/\/repo.mysql.com\/mysql80-community-release-el8.rpm\" &&\n  sudo yum module -y disable mysql &&\n  sudo yum install -y mysql-community-server\n\n# database must be started for SQL configuration\nsudo systemctl start mysqld\n# database should start on OS boot\nsudo systemctl enable mysqld\n# sudo systemctl status mysqld.service\n\necho \"__ Altering database root password...\"\n\nmysql --user=root --connect-expired-password \\\n  --password=\"$(sudo grep -oP 'temporary password(.*): \\K(\\S+)' \/var\/log\/mysqld.log)\" <<- EOF\n\nSET GLOBAL validate_password.policy=LOW;\nALTER user 'root'@'localhost' IDENTIFIED BY '@@{MYSQL_PASSWORD}@@';\n\nFLUSH PRIVILEGES;\nEOF\n\necho \"__ Creating database, table, and app user permissions...\"\n\nmysql --user=root --password='@@{MYSQL_PASSWORD}@@' <<- \"EOF\"\n\nCREATE DATABASE IF NOT EXISTS @@{DATABASE_NAME}@@ ;\nCREATE TABLE IF NOT EXISTS @@{DATABASE_NAME}@@.@@{DATABASE_TABLE}@@ ( \\\n  id INT NOT NULL AUTO_INCREMENT , \\\n  time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP , \\\n  message VARCHAR(80) NULL DEFAULT NULL , \\\n  PRIMARY KEY (id)) \\\n  ENGINE = InnoDB CHARSET=ascii COLLATE ascii_general_ci COMMENT = 'testing';\n\nFLUSH PRIVILEGES;\nCREATE USER '@@{MYSQL_APP_USER}@@'@'%' IDENTIFIED WITH mysql_native_password BY '@@{MYSQL_PASSWORD}@@' \\\n  REQUIRE NONE WITH MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0 MAX_USER_CONNECTIONS 0;\nGRANT SELECT, INSERT ON *.* TO '@@{MYSQL_APP_USER}@@'@'%';\n\nCREATE USER '@@{MYSQL_APP_USER}@@'@'localhost' IDENTIFIED WITH mysql_native_password BY '@@{MYSQL_PASSWORD}@@' \\\n  REQUIRE NONE WITH MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0 MAX_USER_CONNECTIONS 0;\nGRANT SELECT, INSERT ON *.* TO '@@{MYSQL_APP_USER}@@'@'localhost';\n\nFLUSH PRIVILEGES;\nEOF\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"d3b0d52b_runbook","main_task_local_reference":{"kind":"app_task","name":"7575a53f_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"MySQL_Package"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"MySQL_Uninstall"}],"name":"b5d49dd9_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"MySQL_Uninstall","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\necho \"Generic uninstall script, goodbye!\"\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"e557590f_runbook","main_task_local_reference":{"kind":"app_task","name":"b5d49dd9_dag"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"WebServer2"}],"name":"WebServer2_Package","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"WebServer2_Package"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Linux_OS_Update"},{"kind":"app_task","name":"Install_WebServer2"},{"kind":"app_task","name":"3Tier_Webapp2"}],"name":"a0484eda_dag_cloned_1","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Linux_OS_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install_WebServer2"}},{"from_task_reference":{"kind":"app_task","name":"Install_WebServer2"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"3Tier_Webapp2"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Linux_OS_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo yum -y update\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Install_WebServer2","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\necho \"__ Install httpd and php...\"\r\nsudo yum install -y httpd\r\nsudo yum install -y php php-gd php-mbstring php-pdo php-mysqlnd\r\n\r\necho \"<IfModule mod_dir.c>\r\n        DirectoryIndex index.php index.html\r\n<\/IfModule>\" | sudo tee \/etc\/httpd\/conf.modules.d\/dir.conf\r\n\r\necho \"<?php\r\nphpinfo();\r\n?>\" | sudo tee \/var\/www\/html\/index.php\r\n\r\nsudo systemctl enable httpd\r\n\r\n# temporarily disable SELinux to prevent httpd to MySQL authentication issues\r\n# this is for testing only and should not be done in production environments\r\necho \"__ Temporarily disable SELinux...\"\r\nsudo setenforce 0\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"3Tier_Webapp2","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\nsudo touch \/var\/www\/html\/index.php\nsudo chown @@{teccadmin.username}@@:@@{teccadmin.username}@@ \/var\/www\/html\/index.php\n\ncat > \/var\/www\/html\/index.php <<- \"EOF\"\n<html>\n<head>\n  <title>@@{calm_blueprint_name}@@<\/title>\n<\/head>\n<body>\n <h1>Hostname: @@{name}@@ at @@{address}@@, replica: @@{calm_array_index}@@<\/h1>\n<?php\ntry {\n  $dbh = new PDO('mysql:host=@@{MySQL.address}@@;dbname=@@{DATABASE_NAME}@@', '@@{MYSQL_APP_USER}@@', '@@{MYSQL_PASSWORD}@@', array(\n    PDO::ATTR_PERSISTENT => true,\n    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,\n  ));\n\n  \/\/ ensure there is at least 1 row of data for the app to read\n  $data = $dbh->query(\"INSERT INTO @@{DATABASE_TABLE}@@ (id, time, message) VALUES (NULL, CURRENT_TIMESTAMP, '@@{calm_username}@@')\");\n\n  $data = $dbh->query('SELECT MAX(id) AS count FROM @@{DATABASE_TABLE}@@')->fetchAll(PDO::FETCH_COLUMN);\n  $count = $data[0]; \/\/print_r($data);\n  $data = $dbh->query(\"SELECT time, message FROM @@{DATABASE_TABLE}@@ WHERE id = $count\")->fetchAll(PDO::FETCH_ASSOC);\n  $time = $data[0]['time'];\n  $message = $data[0]['message'];\n\n  echo \"<p>Database records: $count<\/p>\\n\";\n  echo \"<p>Last maintainer: $message, on: $time<\/p>\\n\";\n  echo \"<h3>Web docroot: {$_SERVER[\"DOCUMENT_ROOT\"]}, file: {$_SERVER[\"SCRIPT_NAME\"]}<\/h3>\\n\";\n\n  $dbh = null;\n}\ncatch (PDOException $e) {\n  print \"Error!: \" . $e->getMessage() . \"<br\/>\";\n  print phpinfo();\n  die();\n}\n?><\/body>\n<\/html>\nEOF\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"4a161ce1_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"a0484eda_dag_cloned_1"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"WebServer2_Package"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_WebServer2"}],"name":"9ab78648_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_WebServer2","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\nsudo rm -rf \/var\/www\/html\/* || true\r\nsudo yum erase -y httpd php || true\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"e96f5315_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"9ab78648_dag_cloned_1"},"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"8d7a5c0b_deployment","min_replicas":"2","default_replicas":"2","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"4","package_local_reference_list":[{"kind":"app_package","name":"Package2"}],"substrate_local_reference":{"kind":"app_substrate","name":"WebServerAHV"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"4e46245a_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"Package3"}],"substrate_local_reference":{"kind":"app_substrate","name":"HAProxyAHV"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"03185f76_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"MySQL_Package"}],"substrate_local_reference":{"kind":"app_substrate","name":"MySQLAHV"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"e429b102_deployment","min_replicas":"2","default_replicas":"2","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"4","package_local_reference_list":[{"kind":"app_package","name":"WebServer2_Package"}],"substrate_local_reference":{"kind":"app_substrate","name":"WebServerAHV2"},"variable_list":[],"description":""}],"description":"","action_list":[{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"ScaleOut"},{"kind":"app_task","name":"HAProxy_Update"},{"kind":"app_task","name":"Restart"}],"name":"f64e8214_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"HAProxy_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Restart"}},{"from_task_reference":{"kind":"app_task","name":"ScaleOut"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"HAProxy_Update"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"8d7a5c0b_deployment"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ScaleOut","attrs":{"scaling_count":"1","type":"","scaling_type":"SCALEOUT"},"timeout_secs":"0","type":"SCALING","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\necho \"__ HAProxy installation...\"\r\nsudo yum install -y haproxy &&\r\n  sudo systemctl enable haproxy || true # idempotent\r\nhaproxy -v\r\n\r\necho \"__ HAProxy configuration...\"\r\n# http:\/\/cbonte.github.io\/haproxy-dconv\/1.8\/configuration.html#4\r\nport=80\r\n\r\necho \"global\r\n  log 127.0.0.1 local0\r\n  log 127.0.0.1 local1 notice\r\n  maxconn 4096\r\n  quiet\r\n  user haproxy\r\n  group haproxy\r\ndefaults\r\n  log global\r\n  mode http\r\n  retries 3\r\n  timeout client 50s\r\n  timeout connect 5s\r\n  timeout server 50s\r\n  option dontlognull\r\n  option httplog\r\n  option redispatch\r\n  balance  roundrobin\r\n# Set up application listeners here.\r\nlisten stats\r\n  bind *:8080\r\n  mode http\r\n  log global\r\n  stats enable\r\n  stats hide-version\r\n  stats refresh 30s\r\n  stats show-node\r\n  stats uri \/stats\r\n#listen admin\r\n#  bind 127.0.0.1:22002\r\n#  mode http\r\n#  stats uri \/\r\nfrontend http\r\n  bind *:${port}\r\n  maxconn 2000\r\n  default_backend servers-http\r\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\r\n\r\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\r\n\r\nhosts=$(echo \"@@{WebServer.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\r\nfor host in $hosts; do\r\n  echo  \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\r\ndone\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"a5b1f46f_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"70ad38ee_runbook","main_task_local_reference":{"kind":"app_task","name":"f64e8214_dag"},"variable_list":[]},"name":"WebScaleOut"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"HAProxy_Update"},{"kind":"app_task","name":"Restart"},{"kind":"app_task","name":"ScaleIn"}],"name":"9ce9e4c3_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"HAProxy_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Restart"}},{"from_task_reference":{"kind":"app_task","name":"Restart"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"ScaleIn"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\necho \"__ HAProxy installation...\"\r\nsudo yum install -y haproxy &&\r\n  sudo systemctl enable haproxy || true # idempotent\r\nhaproxy -v\r\n\r\necho \"__ HAProxy configuration...\"\r\n# http:\/\/cbonte.github.io\/haproxy-dconv\/1.8\/configuration.html#4\r\nport=80\r\n\r\necho \"global\r\n  log 127.0.0.1 local0\r\n  log 127.0.0.1 local1 notice\r\n  maxconn 4096\r\n  quiet\r\n  user haproxy\r\n  group haproxy\r\ndefaults\r\n  log global\r\n  mode http\r\n  retries 3\r\n  timeout client 50s\r\n  timeout connect 5s\r\n  timeout server 50s\r\n  option dontlognull\r\n  option httplog\r\n  option redispatch\r\n  balance  roundrobin\r\n# Set up application listeners here.\r\nlisten stats\r\n  bind *:8080\r\n  mode http\r\n  log global\r\n  stats enable\r\n  stats hide-version\r\n  stats refresh 30s\r\n  stats show-node\r\n  stats uri \/stats\r\n#listen admin\r\n#  bind 127.0.0.1:22002\r\n#  mode http\r\n#  stats uri \/\r\nfrontend http\r\n  bind *:${port}\r\n  maxconn 2000\r\n  default_backend servers-http\r\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\r\n\r\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\r\n\r\nhosts=$(echo \"@@{WebServer.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\r\nfor host in $hosts; do\r\n  echo  \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\r\ndone\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"a5b1f46f_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"8d7a5c0b_deployment"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ScaleIn","attrs":{"scaling_count":"1","type":"","scaling_type":"SCALEIN"},"timeout_secs":"0","type":"SCALING","variable_list":[]}],"description":"","name":"aaf64601_runbook","main_task_local_reference":{"kind":"app_task","name":"9ce9e4c3_dag"},"variable_list":[]},"name":"WebScaleIn"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"DatabaseBackup"}],"name":"ba8861e3_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"DatabaseBackup","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\nmysqldump --all-databases --user=root --password='@@{MYSQL_PASSWORD}@@'\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"7d84192b_runbook","main_task_local_reference":{"kind":"app_task","name":"ba8861e3_dag"},"variable_list":[]},"name":"DatabaseBackup"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"ScaleOut2"},{"kind":"app_task","name":"HAProxy_Update"},{"kind":"app_task","name":"Restart"}],"name":"6c8d2d3d_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"HAProxy_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Restart"}},{"from_task_reference":{"kind":"app_task","name":"ScaleOut2"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"HAProxy_Update"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"e429b102_deployment"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ScaleOut2","attrs":{"scaling_count":"1","type":"","scaling_type":"SCALEOUT"},"timeout_secs":"0","type":"SCALING","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\necho \"__ HAProxy installation...\"\nsudo yum install -y haproxy &&\n  sudo systemctl enable haproxy || true # idempotent\nhaproxy -v\n\necho \"__ HAProxy configuration...\"\n# http:\/\/cbonte.github.io\/haproxy-dconv\/1.8\/configuration.html#4\nport=80\n\necho \"global\n  log 127.0.0.1 local0\n  log 127.0.0.1 local1 notice\n  maxconn 4096\n  quiet\n  user haproxy\n  group haproxy\ndefaults\n  log global\n  mode http\n  retries 3\n  timeout client 50s\n  timeout connect 5s\n  timeout server 50s\n  option dontlognull\n  option httplog\n  option redispatch\n  balance  roundrobin\n# Set up application listeners here.\nlisten stats\n  bind *:8080\n  mode http\n  log global\n  stats enable\n  stats hide-version\n  stats refresh 30s\n  stats show-node\n  stats uri \/stats\n#listen admin\n#  bind 127.0.0.1:22002\n#  mode http\n#  stats uri \/\nfrontend http\n  bind *:${port}\n  maxconn 2000\n  default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{WebServer.address}@@,@@{WebServer2.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\nfor host in $hosts; do\n  echo  \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"a5b1f46f_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"00a11df3_runbook","main_task_local_reference":{"kind":"app_task","name":"6c8d2d3d_dag"},"variable_list":[]},"name":"WebScaleOut2"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"HAProxy_Update"},{"kind":"app_task","name":"Restart"},{"kind":"app_task","name":"ScaleIn2"}],"name":"bf5b779b_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"HAProxy_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Restart"}},{"from_task_reference":{"kind":"app_task","name":"Restart"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"ScaleIn2"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\necho \"__ HAProxy installation...\"\nsudo yum install -y haproxy &&\n  sudo systemctl enable haproxy || true # idempotent\nhaproxy -v\n\necho \"__ HAProxy configuration...\"\n# http:\/\/cbonte.github.io\/haproxy-dconv\/1.8\/configuration.html#4\nport=80\n\necho \"global\n  log 127.0.0.1 local0\n  log 127.0.0.1 local1 notice\n  maxconn 4096\n  quiet\n  user haproxy\n  group haproxy\ndefaults\n  log global\n  mode http\n  retries 3\n  timeout client 50s\n  timeout connect 5s\n  timeout server 50s\n  option dontlognull\n  option httplog\n  option redispatch\n  balance  roundrobin\n# Set up application listeners here.\nlisten stats\n  bind *:8080\n  mode http\n  log global\n  stats enable\n  stats hide-version\n  stats refresh 30s\n  stats show-node\n  stats uri \/stats\n#listen admin\n#  bind 127.0.0.1:22002\n#  mode http\n#  stats uri \/\nfrontend http\n  bind *:${port}\n  maxconn 2000\n  default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{WebServer.address}@@,@@{WebServer2.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\nfor host in $hosts; do\n  echo  \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"a5b1f46f_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"e429b102_deployment"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ScaleIn2","attrs":{"scaling_count":"1","type":"","scaling_type":"SCALEIN"},"timeout_secs":"0","type":"SCALING","variable_list":[]}],"description":"","name":"ffce4d82_runbook","main_task_local_reference":{"kind":"app_task","name":"bf5b779b_dag"},"variable_list":[]},"name":"WebScaleIn2"}],"name":"Nutanix","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"USER_INITIALS","value":"yrsl","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"MYSQL_APP_USER","value":"webapp_user","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"regex":{"should_validate":false,"value":""},"val_type":"STRING","is_mandatory":true,"description":"MySQL low password security requirements are 8 or more characters with at least 1 uppercase character","data_type":"BASE","type":"SECRET","name":"MYSQL_PASSWORD","value":"FBEV10lLaOC87rou3MowVLpbkt7cLasqQrS6K\/OEbMpf2vfPPFxKkCmU:utf-8","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":"SECRET"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DATABASE_NAME","value":"webapp","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DATABASE_TABLE","value":"tecc_dba_test","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"regex":{"should_validate":false,"value":"^[\\d]*$"},"val_type":"INT","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"VLAN_ID","value":"999","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"regex":{"should_validate":false,"value":"^.*$"},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"VLAN_NAME","value":"999","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"superuser"},"type":"USER"},"name":"Production-3Tier-Application"},"api_version":"3.0","metadata":{"last_update_time":"1606950651798177","kind":"blueprint","spec_version":12,"creation_time":"1606948474905646","name":"Production-3Tier-Application"}}