{"status":{},"contains_secrets":true,"product_version":"3.0.0.1","spec":{"description":"Production 3-tier Web Application","resources":{"client_attrs":{"None":{"y":249.5242543044,"x":36.8952403805},"e429b102_deployment":{"y":53.5201580181,"x":133.1377783805},"03185f76_deployment":{"y":-161.5019891424,"x":-102.7927721011},"8d7a5c0b_deployment":{"y":-315.6286038851,"x":94.9675421431},"4e46245a_deployment":{"y":-149.7586147439,"x":355.7438380633}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"445785e9_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"86a105c6_runbook","main_task_local_reference":{"kind":"app_task","name":"445785e9_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"fb828d74_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"aa113063_runbook","main_task_local_reference":{"kind":"app_task","name":"fb828d74_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Restart"}],"name":"ff47f0bd_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"fa66a9e2_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"ac60fe4f_runbook","main_task_local_reference":{"kind":"app_task","name":"ff47f0bd_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"WebServer_Stop"}],"name":"a11b8543_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"WebServer_Stop","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl stop httpd\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"98fef3d7_runbook","main_task_local_reference":{"kind":"app_task","name":"a11b8543_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"WebServer_Restart"}],"name":"f214dae0_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"WebServer_Restart","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl restart httpd\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"fa66a9e2_runbook","main_task_local_reference":{"kind":"app_task","name":"f214dae0_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[{"kind":"app_service","name":"MySQL"}],"name":"WebServer","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"b2d7da13_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"dbbe6873_runbook","main_task_local_reference":{"kind":"app_task","name":"b2d7da13_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"bca79f09_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"f5e3cc48_runbook","main_task_local_reference":{"kind":"app_task","name":"bca79f09_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Restart"}],"name":"1ed67621_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"a5b1f46f_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"6ad336ea_runbook","main_task_local_reference":{"kind":"app_task","name":"1ed67621_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"HAProxy_Stop"}],"name":"5d9ab5c9_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Stop","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl stop haproxy\r\nsudo systemctl daemon-reload\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"48e7907c_runbook","main_task_local_reference":{"kind":"app_task","name":"5d9ab5c9_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"HAProxy_Restart"}],"name":"e7ac7d5a_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Restart","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl daemon-reload\r\nsudo systemctl restart haproxy\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"a5b1f46f_runbook","main_task_local_reference":{"kind":"app_task","name":"e7ac7d5a_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[{"kind":"app_service","name":"WebServer"},{"kind":"app_service","name":"WebServer2"}],"name":"HAProxy","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"4106c183_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"fe7b3f6d_runbook","main_task_local_reference":{"kind":"app_task","name":"4106c183_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"904da31e_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"279a8350_runbook","main_task_local_reference":{"kind":"app_task","name":"904da31e_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Restart"}],"name":"68b60125_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"507995ba_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"135ab4b7_runbook","main_task_local_reference":{"kind":"app_task","name":"68b60125_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"MySQL_Stop"}],"name":"a89dd3ba_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"MySQL_Stop","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl stop mysqld\r\n# sudo systemctl status mysqld.service\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"4cbddf9d_runbook","main_task_local_reference":{"kind":"app_task","name":"a89dd3ba_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"MySQL_Restart"}],"name":"f8a00a3a_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"MySQL_Restart","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl restart mysqld\r\n# sudo systemctl status mysqld.service\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"507995ba_runbook","main_task_local_reference":{"kind":"app_task","name":"f8a00a3a_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"MySQL","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"445785e9_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"86a105c6_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"445785e9_dag_cloned_1"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"fb828d74_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"aa113063_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"fb828d74_dag_cloned_1"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Restart2"}],"name":"ff47f0bd_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart2","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"fa66a9e2_runbook_cloned_0"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"ac60fe4f_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"ff47f0bd_dag_cloned_1"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"WebServer2_Stop"}],"name":"a11b8543_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"WebServer2_Stop","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl stop httpd\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"superuser"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"98fef3d7_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"a11b8543_dag_cloned_1"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"WebServer2_Restart"}],"name":"f214dae0_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"WebServer2_Restart","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl restart httpd\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"superuser"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"fa66a9e2_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"f214dae0_dag_cloned_1"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[{"kind":"app_service","name":"MySQL"}],"name":"WebServer2","port_list":[],"tier":"","variable_list":[],"description":""}],"substrate_definition_list":[{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"WebServerAHV"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"b3b9217a_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"5b00ccaa_runbook","main_task_local_reference":{"kind":"app_task","name":"b3b9217a_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"WebServerAHV"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"bdffec80_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"9e63a82d_runbook","main_task_local_reference":{"kind":"app_task","name":"bdffec80_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AHV_VM","name":"WebServerAHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"editables":{"readiness_probe":{"connection_type":true,"delay_secs":true,"connection_port":true,"timeout_secs":null},"create_spec":{"name":true,"resources":{"nic_list":{"0":{"subnet_reference":true}},"serial_port_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"boot_config":true,"disk_list":{"0":{"data_source_reference":true,"device_properties":{"disk_address":{"adapter_type":true},"device_type":true}}}}}},"os_type":"Linux","create_spec":{"name":"www@@{calm_array_index}@@-@@{calm_time}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"234d6088-a83f-4208-820c-f8d98f609c22"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":1,"gpu_list":[],"memory_size_mib":1024,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\r\nusers:\r\n  - name: @@{teccadmin.username}@@\r\n    ssh-authorized-keys:\r\n      - @@{teccadmin.public_key}@@\r\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\r\n"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"c441c8fc-2811-45aa-8622-f817b45f562e","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_8_Cloud","uuid":"d878456e-89ab-442d-b1e8-fbcefb88f0c2"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"HAProxyAHV"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"6ca6559d_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"bc2e3487_runbook","main_task_local_reference":{"kind":"app_task","name":"6ca6559d_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"HAProxyAHV"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"c33a8b7a_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"2a8804a0_runbook","main_task_local_reference":{"kind":"app_task","name":"c33a8b7a_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AHV_VM","name":"HAProxyAHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"editables":{"readiness_probe":{"connection_type":true,"delay_secs":true,"connection_port":true,"timeout_secs":null},"create_spec":{"name":true,"resources":{"nic_list":{"0":{"subnet_reference":true}},"serial_port_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"boot_config":true,"disk_list":{"0":{"data_source_reference":true,"device_properties":{"disk_address":{"adapter_type":true},"device_type":true}}}}}},"os_type":"Linux","create_spec":{"name":"HAProxy-@@{calm_array_index}@@-@@{calm_time}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"234d6088-a83f-4208-820c-f8d98f609c22"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":2,"num_sockets":1,"gpu_list":[],"memory_size_mib":1024,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\r\nusers:\r\n  - name: @@{teccadmin.username}@@\r\n    ssh-authorized-keys:\r\n      - @@{teccadmin.public_key}@@\r\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\r\n"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"c441c8fc-2811-45aa-8622-f817b45f562e","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_8_Cloud","uuid":"d878456e-89ab-442d-b1e8-fbcefb88f0c2"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"MySQLAWS"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"f9ce6562_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"90ee9fff_runbook","main_task_local_reference":{"kind":"app_task","name":"f9ce6562_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"MySQLAWS"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"70de6d05_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"67bb64a5_runbook","main_task_local_reference":{"kind":"app_task","name":"70de6d05_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AWS_VM","name":"MySQLAWS","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{public_ip_address}@@","delay_secs":"120","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"os_type":"Linux","create_spec":{"name":"aws-mysql-@@{calm_array_index}@@-@@{calm_time}@@","availability_zone_reference":null,"backup_policy":null,"type":"PROVISION_AWS_VM","cluster_reference":null,"resources":{"instance_profile_name":"","availability_zone":"us-west-2a","subnet_id":"subnet-2fba1a57","key_name":"HCE-KP","region":"us-west-2","instance_initiated_shutdown_behavior":"","user_data":"#cloud-config\n# https:\/\/aws.amazon.com\/premiumsupport\/knowledge-center\/ec2-user-account-cloud-init-user-data\/\n# omit: security-group of VPC for SSH?\n# omit: SSH-keypair in ec2 region, skips creation: ec2-user\ncloud_final_modules:\n  - [users-groups,always]\nusers:\n  - name: @@{teccdba.username}@@\n    groups: [ wheel ]\n    sudo: [ \"ALL=(ALL) NOPASSWD:ALL\" ]\n    shell: \/bin\/bash\n    ssh-authorized-keys:\n      - @@{teccdba.public_key}@@\n      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC8ZzG4f1TfEZ2YRgDcPSQjb+fxbtRS4m1dr\/EcqwqIxiV6nU9Ft3PrTqC8qFkhBjOvSJJ3GeEMCZnvEK9Iq8F+R0G3pa29fZeRA8Ur3PM4d2kb2ZhEYLMmnhKJoSTJw4c5PxaZ4ZXKUH+yATQUsLrwoYsHEC6bAvKl0+yFspQYehaiEEO17o3KQUq\/izU7Agi4vETAuR7\/dlKwzj1sG8fikaf351gmQhIHd+nXxIY9yTA3CpvfeKTJ77aHN0Cg+HwXg9X+c0+P\/6zMfo87oru25qnPX5ITa2TfposQWp1xASGrrJX5B6rNYuQQKzVo5OO7VfFEKDsDlzGAkDVlD797xVoq+\/HN6G5gsi82jujBb1X9kyCLGFNhXsseGcqYelBMWmHKHTp69\/vnWcjT1dCB4OWEQr5ARcxYc5zNXV4N2CVYwH4iF70ztt4Dd7\/4gmvXWmzyuc0j7gd+QHz0BwxJTGZu+MPPXu8xAYtcCSAh\/SQFzL7xhnbsIrDj2mXBwOi36vxPQ8APRstr0dtEYivwyPyVb7lzR2SGmQNlHxB\/F\/xdiHszqD+\/c4DGZqW4xj+I6ICu\/19lh3gi2rLvrGF86EPTQ3hQKtpv6\/t2O+UXONnc+Ayc5dKh6baC6IbwGQnT0tLDPTXM5+o3M2a0KefdqmzL6\/gekpATS+scqb6tPQ== mark.lavi@nutanix.com-2018-05-21-passphraseless","image_id":"ami-01e78c5619c5e68b4","instance_type":"t2.micro","state":"RUNNING","security_group_list":[{"type":"","security_group_id":"sg-57a72f77"},{"type":"","security_group_id":"sg-0da4cff0820cf5417"}],"block_device_map":{"data_disk_list":[],"type":"","root_disk":{"size_gb":10,"volume_type":"GP2","device_name":"\/dev\/sda1","iops":100,"snapshot_id":"","type":"","delete_on_termination":true}},"private_ip_address":"","vpc_id":"vpc-5691c62e","tag_list":[],"type":"","account_uuid":"1bed6d4f-c7d6-7a55-8903-05a45d7c11ce","associate_public_ip_address":true}},"variable_list":[]},{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"WebServerAWS"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"776c2fcf_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"b73a00c7_runbook","main_task_local_reference":{"kind":"app_task","name":"776c2fcf_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"WebServerAWS"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"04f9e143_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"d24c0578_runbook","main_task_local_reference":{"kind":"app_task","name":"04f9e143_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AWS_VM","name":"WebServerAWS","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{public_ip_address}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"superuser"}},"os_type":"Linux","create_spec":{"name":"aws-web-@@{calm_array_index}@@-@@{calm_time}@@","availability_zone_reference":null,"backup_policy":null,"type":"PROVISION_AWS_VM","cluster_reference":null,"resources":{"instance_profile_name":"","availability_zone":"us-west-2a","subnet_id":"subnet-2fba1a57","key_name":"HCE-KP","region":"us-west-2","instance_initiated_shutdown_behavior":"","user_data":"#cloud-config\r\n# https:\/\/aws.amazon.com\/premiumsupport\/knowledge-center\/ec2-user-account-cloud-init-user-data\/\r\n# omit: security-group of VPC for SSH?\r\n# omit: SSH-keypair in ec2 region, skips creation: ec2-user\r\ncloud_final_modules:\r\n  - [users-groups,always]\r\nusers:\r\n  - name: @@{superuser.username}@@\r\n    groups: [ wheel ]\r\n    sudo: [ \"ALL=(ALL) NOPASSWD:ALL\" ]\r\n    shell: \/bin\/bash\r\n    ssh-authorized-keys:\r\n      - @@{superuser.public_key}@@\r\n      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC8ZzG4f1TfEZ2YRgDcPSQjb+fxbtRS4m1dr\/EcqwqIxiV6nU9Ft3PrTqC8qFkhBjOvSJJ3GeEMCZnvEK9Iq8F+R0G3pa29fZeRA8Ur3PM4d2kb2ZhEYLMmnhKJoSTJw4c5PxaZ4ZXKUH+yATQUsLrwoYsHEC6bAvKl0+yFspQYehaiEEO17o3KQUq\/izU7Agi4vETAuR7\/dlKwzj1sG8fikaf351gmQhIHd+nXxIY9yTA3CpvfeKTJ77aHN0Cg+HwXg9X+c0+P\/6zMfo87oru25qnPX5ITa2TfposQWp1xASGrrJX5B6rNYuQQKzVo5OO7VfFEKDsDlzGAkDVlD797xVoq+\/HN6G5gsi82jujBb1X9kyCLGFNhXsseGcqYelBMWmHKHTp69\/vnWcjT1dCB4OWEQr5ARcxYc5zNXV4N2CVYwH4iF70ztt4Dd7\/4gmvXWmzyuc0j7gd+QHz0BwxJTGZu+MPPXu8xAYtcCSAh\/SQFzL7xhnbsIrDj2mXBwOi36vxPQ8APRstr0dtEYivwyPyVb7lzR2SGmQNlHxB\/F\/xdiHszqD+\/c4DGZqW4xj+I6ICu\/19lh3gi2rLvrGF86EPTQ3hQKtpv6\/t2O+UXONnc+Ayc5dKh6baC6IbwGQnT0tLDPTXM5+o3M2a0KefdqmzL6\/gekpATS+scqb6tPQ== mark.lavi@nutanix.com-2018-05-21-passphraseless","image_id":"ami-01e78c5619c5e68b4","instance_type":"t2.micro","state":"RUNNING","security_group_list":[{"type":"","security_group_id":"sg-57a72f77"},{"type":"","security_group_id":"sg-068c71e27a29804ac"}],"block_device_map":{"data_disk_list":[],"type":"","root_disk":{"size_gb":10,"volume_type":"GP2","device_name":"\/dev\/sda1","iops":100,"snapshot_id":"","type":"","delete_on_termination":true}},"private_ip_address":"","vpc_id":"vpc-5691c62e","tag_list":[],"type":"","account_uuid":"1bed6d4f-c7d6-7a55-8903-05a45d7c11ce","associate_public_ip_address":true}},"variable_list":[]}],"credential_definition_list":[{"username":"teccadmin","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"uXAFOSYQ56Lfo0USWTKiLiuwAbf34yq+qaVeG9\/oS3eY06gb9chpqAILgfx3lVhz6d1oRtzqV\/xx+skLl4tJg7THHOLHbtqR2SYSMNRu6F1s0xQcCapzM3vqb8FIZy8PF2eLvc84vLanQg7MqiW1A7VyZw+gC\/IeEETvUw\/uV78NzXW5Tw6ndqVwa3sVMvdm0NhSHzRaXYcdeNRGnlaI3qvwNLVA0ICmJYwYUXGu+2iGw39g8awjo3yEnBHLLgW2eH2av1M1QT80afRWAmnZG8+R\/TpYrNFF05TYzrZwl0F0OT503SnNoBWwSZG2DwswS6vX9bVdOACUagqpAUP678SE3DHP3y\/xl78Rb3lhCqgZrpWYCVTn5lAfaDXh\/aCvOwuHsyqRm\/h47VGkKs1Amv2\/LgABDqjiTKyiKJIDN1yD94J\/xneNlkJfnDoKfoumyv5nh6Ko+jm0kGGILvgO4kbPlFeZWpF+awH+d7KFtE1\/9QsQlWUCs+gN\/baEcfEYmtRHBA34vSc5K97O0VPjah7DSYpogYpCI977TyBe2k+68Rtyy24UjCmeaUZBxsWErt6Z3EVGm91S6C+KCvdGPqyGbzx7q7n4KZyDSjeymzYTtBQSdQxPUYSQqudcm\/j4z3pNnlWM4p5TbsmGQP3DP0MfcTZhlcivtSu6YofWzlrvgKbGfckXAL0f8Mtqba2kCo0pHGjbZO6KC7hJnaHFABaszqOxZYCJs1aWWJu7\/uEPw2IhItd6oJ9biK0CYb7P3j\/Ov1GWievDKgYzg5KilQ4CeLIWFc\/FFBx4eEpG\/KjWnhkTmNLHaBsGYhPnpl2EzOxDi74+x6y6Pm2l38DhLwAa6v\/\/bL5PaqDZUHTHym5R6wC4Il4pmE4A8tInO84zDbBGHIzJN\/2sNRAHJ6C2kFtCdB2GIQYQ\/A5+Ma0VCOsnrTXv6CTH4HHQIVtHvfVde0r8qTZMuJrX9BWHKyqf0zbnuqJGrPsrHpag4m59eTbD1\/ayFpuWgJNNqrJeiqGL1fCvJRy9BvgVfk98Y4TD0ApwPTUuDvTIHhwtDKt+vIY8MXuVPqIecV1rJ5qTfJq8QH1f3CkYXZr9ZeKkXWU96\/6WYokLctxePjC21litXJV0MiokUGEz1jdC79AdzHHhkttHVlcujSrioZ8arx274dvo6T55bRuKklieCk\/AMHh5MoLvM8R\/hr09G4kpDLi2+qsx8Iknab6fswqHxMg06iPIHIwx1oRKjJPELrDh3H9tYh8QGwwaIdttA3L8rSRFVAklxUqvZuv2Pq2BCBDWorY2RHpqRKlgSBZqu1ycHx2zZYpF\/YCzCJXRN5bjqmQtl8O0lYlnZ9k8eVNqEjXdKzDxCKMk+RNB5Qr4OSvL8UgHF4JXA0CY4wLNz77mfdKi+gisEx7bE4no+yYpDKxy1sAMsEdQJfTwb3D84PnzuD3357+u3v+aEufeZLv13+Swrg62ejxL0WAUUYPRtBSYPc8rIUguxOXsdY79WxMqVBonVxQhTSUtLlu\/2kSEGAkpjlVtfW0W46IjK9drOxImc2Q7KOE\/cIMNjVj\/z+4wipRXILl75bSFqkkUI6zsUcAGUzHYdDnAi9yJoA5fHHPTrdJgJak83hv\/HgijP8EvcCDLR8+ymuQI8Vg\/ll4fiJAR0Ha8K9kDn5KwX7bnqftda6uu0X8oMJtGM3UXlQjJDvjtlXCYLxHa0Crr9WbFhlfKm9PoS4eaZLlMn4t7a9kop2lDJGdPPOWXgZytxcJ8zZd8+0YTC3lu8F6SZL8yhJA2oXixPE6ViPDHYaVlLdEAptCfUVdWmMm+Lgm5UT4w6EMRUlbbxlxBE0nQ8Y0YVHvdM1PySY351YL9ral2CDHw1R0pDNBNHa9KJ\/o0htoCPuYmwv3M5SZdzyr04VOcjQrZY1qNILZl8rHaD3ybmdKPtHv2ri7xd4NWlrPAjeYHhsHXav4mg61ZHOb69Bx6ng6S82gs0tJCibSymWfVeaAMBx+HxX6rjU\/nYkcCoY26kVg0MHUeQqHWuvn9Ldpffod+o156WMg+PrM46vUe6MLKgA\/ZoIxhlOa3E0PSvHq2P3NJoGCHuKP4SeD2KJRA0AQIu3Y\/3MdpZvBWG2gGJAJFhLDQRcHxJdAMJe6s11fIQp7JLOZDcRVcldHhkogcMblSJkipaNoLsRCb\/E6zN\/JGnrUbQ0X\/iDZtRtB+NfPfGng5GR8jTZcyJP209ZV8UXPR5IYknAHCQ5SHNl0GlnBXIfpHkDGrk8h\/AfswaCZP+o\/LJhQxhlHsJ0kSNYQu\/KExnXqVt1EEt0vsake44lDFXoUM5+A8OfqAeM7ujf\/QLcC8vFm4DzWLCCjMC1ziiGVTIUY7Xh639YwpPCquW6DG46JNwI7UWnbxhXJeqzy7iOSKtztMjrIzPN+CXj7kJIGH\/jSlf2Uh3SN4EhAc6DBLdQFbqBLsUZXPX\/\/FFT33GjkIxjkW0qvqGZunAGNDwROpdc7UB1vecqZT7V5sx9EASCgvi4Tba9H\/2Krsufd0mTOGgC48\/S88ms2SnkrdncXdnhC95tYu8yMXroQABlJ1nvw1k5O2zew0XqFLR5dOD\/K4PO\/Wu2tCV7a4TWplOCiRzHPm7I0ub4IwMi4NHAIs+ZMdi8yKV1KQFF4srmJBQxR0pWO3aQDJyH4\/XDFkeKjxKgzo+4WSAfttI1zx1qhzqmqPMOyWXLcgq\/ZsD+E1tHOqXintIYproCZcrO3x2C6CqTRmP2qwc8+knwRo7Scv2bvfzLYBEBCsBNvYmEMheXs5q66F\/SialmSHToIswlFKWAXXTShUJB12MkikoupcMYYSOiUfN2aCTanVjJW95IA3DUWn48OzrrDJ9T2M8WkCpGtPK61IoILLIWYn3IIHPLli9ajnQmAb2BjWrJZFRFphIHxOyh7c8kSk\/UAUf7ZURzbrpWjkgk0xfEPdxPcdn1QLTz564afAuMkpJ\/tyCdpqfB\/faLxU+oQI3pp0ROaD7FwXZF34g2c8t7WFl5lDSGj6yHxEZmG\/YxYYPvgggutsaD76s7VUQ+aalQWXmKqKuA0dKqYDWX\/az4d4eyKUmMNe8\/eTOk5NzY\/jo17Hxvsv8JYSVLJFqbcYdPqt2OuApVFMjmx\/NtpwKjPuvtX47ek6YwZ05pfUo9M8CViYEtPh9lAqTvmFIhrV6MXZ89mjVuOn9V3Q3LDZvJMOAfnETt\/fSjn2gRnom16A4ILtCVvmIRwm2yCppaM821nPg\/R7bJxF93bdUnZj9cGkgXqoFUV2\/vCf0iZnjyIGMfPJy6HxwGupcy6D:utf-8"},"name":"teccadmin"},{"username":"teccdba","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"z\/A7LcSzM4Q\/yb4eR7xNlloGQ9q\/VebaBawmNlpQcDa1MKekd1QyQmu\/TnBlh6Bw1Pft28NI5C11R+Ip4dQZy9eUtUQGm4ZhvxiE6P\/jXtWRC\/FBV0AdFK48OKZ0wJXxatfIl1NguIsf7dKBPVHpRLcyWr8vZFdO0CQpF7VGCPubIZWEBUbNANbQ85u8z4ouRhbkLLB3GJc2J6Oggg2aCdUuP7pasB\/ndHaFe2LNHmp\/9SJGNywbOwmFBJwCuKvTe9ZwhyfCj+hkicMNhf0NJ3BoLiby7MwMDvtxI13fRCNjbZMMl6gFT5nXw5k8lELE0CiIunl17Fg4LxPsyUPaU6yG+rERiC\/MhX6bd4YEzXooQ3kmANTatV9I+GFVo2DV4SKdkI5+RO26DA6+D++P\/riFA2\/x29W9wzs7gmQq1xkOas4v1XHMmxi9h0RVE0AS0gJWlD+8jhLwyZ8UzYZypAin43ehdx1OFTN6BrCbE0RyMGlliA46P5SDx6FjY+MV3nDbNzYqPvYXVqsaY37ggcouRha6KpxdK1QKCcgBgpE0yy6W9Po9FYLi35gKD3OpRNmz6oAxBZlCDjr89R7j4iiPKAnNfFY2x\/z+Hv9QHja2E+Zl2Owlhd0efHa2xnn1LpPMSWTSctA8zr7LTRuOKF46X1t786t+QdfpbxVbJUDpWKVW4nHXq1TVxYtlyrAC6MwjSNWpTjTXgVD0UnRZpUMSar87rCFF3PDcOxsGD0Lv5XY36aWG5u45\/t3Yfgicfz46Hjkoa06GRLhPfLfieGrDaeWf1Z42jbF9DIGArV+uvc77VcnTjXTSFaynGtR24k2+BEQi6Fhv1YY92bYdl8tCgBI0fE5bxoOsjxWkCypegF6uagF7U3iZvWVLk0WAQ1Zz4+V4\/MclsmJK9MB7AcJ2fp3ceHlT31+3WO8k19Gnw6cu5D3BlukM5ZCUJ+KwQYlpfYQTwUmyfafhl1L3orwZnTLZWvYXoXUOQhpy8NHXHBBy7i5TFENrzudHF+ic8EYnB5nc5Z\/6+KAgm2xf8beg9v8DIZPNdg2hRejek0\/DF3VeytBb5n1S+hBNB1a4BQjpul7Tn4AKMdyVzJzEcP4rvEbTLBQnDc1aAox3G5le6kVRtgw2u\/yAaluzqdQuV\/yTf3g3UGIovCcVbEq6ya0CprhKgtWz645XXNENXLgaluaQn\/uiyH8r237fjfmMJznth5kY3gFW6OLvmmt90ZywPBJWw7XbUk9av2bW2tTwlEoaPxHOnxa\/H\/8SjYDpCWqeSaXWE\/9yJNy75CMsjt+mSoHEg+9Vzg6qUoFXSnjdVlIwbur+Hw1Qc7dlx8v2MG0JaDpOE0IaFb3ukKvgEA3eu0gmXr+ViqWnpVSxzQ4uJT\/5QUacHFPqWrwozbChJt9dAxZSah53k2wbgdHc7lgjo60dsZe5XKtIj8X+Xg8wP0\/E2\/qMy1Xph3AEVNm54Gp7g7LGlWlBsbdgrxBYEx0xUXMMoN8UqZv2Tmd3Bkba\/xwTsT0e\/+ZXljvp4UEefXiIc5oIEdbsRpUkl\/SwbSvX7fgcuXDF\/cjPIFTFfs27RG9TgSSw2t1j6MHei37DEITeF9c5WTXLEzadfm\/ybzeKaUrv3io6ad\/CjQd0lxnFoegSyzNsAjd+2\/VlVWqPa0lT8okYTUmkETeJx6uQRTxxXBpcEBlXLuR\/dFv\/Xc+51KKLtdB9RspHqbIcuBWT9+xusQpNe8uvZq7HJmFie7PxAa2o6YctcQZhtKChHYOIpv0vFxrMHpigaMmD9ja5sQZ1T+o0IAKIfTsCGwH8JdlIUPfmBvijUSblhvzKQ5oh+glc6NuAv6mLKDxj153vatjuyWC5T+1CMFWiUNq3tgsFt6qEwAb0g2wqNqrw+AOaFpT\/SyP3GZw8UY55KkHuVwh+uCZtSoSP2REsjKg4CUmtW1nvMoPqNChlMeGdi0Kvkhr1Rf7hRwYP8rDyPLWiSS11efJVdYITVnRf4w\/eE7aWGP3\/MPhufC0wkY6sLdxiSrz9CXdgf6cixIKV5o6RwQ7kOWtgJUznFXPa21fESaUMr+AcIwNDxcOl2eLsHQy9pSSLU7HZa71Ypl9SjknpfeLeSaeE+\/SW8Zv8iQcxYZw+GgjAapye5egHm08H0HmTocBRyynS+u24aJT9SbjWIQ7JOs0a4mM3Y2+x6jayK\/K7csl4KqQ+wcSoXH8EGT0aJthlhWjjqfNsqkDZ9VlVTyOGyMvN2oVEWEnJcRaLld5HU2tygDsAJfxCVXc1q+fPMEGL2EHD\/JTJ8DbGfZfvDNrOdn5\/LpgSe7nG407LGAzXVkuc3+cH2sUPVNzEfLP\/OptGGck\/gd7127OSEMXBKXhO8bOYzj7LzMlj9EZy\/Qo35545rwhqllO8FbMHv\/bqSQc3d5ca1UGbGvVDekNGgCzYiV6dCYw3kmx0clKEf5F9Kqun7gDvxiGs69QYOdVShAZJ+9th+dw7GieEM6PJZdy8cIHcIVIAsq5AbQ\/6nef6H0ceo8bVGYtLR6nOYYl4BtbVvSmJvV+ULvf1t5mXve3qwZmgynprD5a\/h5f58cyXiTsJ10Dw9RFHbGAXNkVK1Dhjagvq5JHAuTT7GgUWBNB5Xyf3lUkFWv8fD\/HJGdfPJgpUg+MYZP9X8UhcR0k3FVZ93hemvxji\/9RfOTdv9TeRgrtXMkD28CXsv8NL0H6NTBh+FVMIjX0kti\/rsNxhllwhCcaL42gJqq5kxMGh6sfB2VMWYHutc5yCynfJu+ksXKeoXcD7CEk6gP1DH3dv827XE56yVE9ruy36h9eUoZEH3z0nk7CO9BxD0mtkGIkWW3k3hc3XTyPz6+kSJ3JFBo6hsMxW1fXS1IHhDMpowQt\/1hGy6\/kfL7pIPGIr0xvYDh1SeYAUj++l9TKB+la+cIxoCwPJMQ9ap2rKdxrQV0seHEHPdVtO\/CMCwo++WeZrJrJaXK5RRGzmRRp2BVkwfARxALt+9j0Irrf78LzqTe1RsxHubFl0RsE8pgmupL2WidEQoViQNuy2URTE2B\/J7Y448jsq2dlpI9XBLgVqWePxL7iXFdKIwOiMIuBVvzKRqS9Kor4gsZ\/wIgfwPsmDCuQ0B31BkHeex9\/Guo6zQ3qRk2chKtM+dQFE4I6LrtGWsmBlgkZsitbU1DnvBLHYdCiq0QcSimhzPvmHfqQWD8Qg6kg6oDhPWFDhpJqxIPUrcLEeAMuufm2BLXZvrH22uBvYZQbnYLJ5yWyeLduUtAdXru3chPNeC89ye5\/XRTFjGJubl7r8AUIexgSz2lHuHCFpv37S:utf-8"},"name":"teccdba"},{"username":"superuser","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"DEl6AOTItkRI7FNM\/Arnnha98iOsoNj1WXVftM\/+LnOwYvRZtUDuZR\/1IdEmG7cinZLHrgyDOq4VtTxc\/56OdaCF5h4INIjOSC+AWHJKfTsGXMOMMZ3U\/ej\/oouBbFuCSm9DLlJH+NeAQrFbDrUZQVrsw6RNy1Gb0aEM71LRwvvzsTeTaHj+h2\/AwP02bFgvT66qShq3bsInW5KXzZ2L\/TJlEcqwBna4Q9xJukjUuP9NPdEEgP1hlXOJiKJ675FK6YsTQuA0Izf0vSALdS2L3dEmnr2ts2kSgeo5WXyWwJFkgM3VzLpkuz+q7O3rPnmB+wW+px6qbcA8m+G9mRD8ngKuV39Teti\/2U920hbuze36cgVprQFODpcUfNN4MJVRuOH+TDxiLjKui2mOjTmR+Tf4gAzgMmjkp90jsf7ZGRRHxfvlZ71SNIijn8ogkXablngvF5mevGJJNZGv0qACoZMbrQlXbStEvxhCBzfzw1704FWHR8oi2sXxHQrMJBD1ITWKxpiOjBGG\/K6ESkrCe5ZJCO3oe2HoTZ0fdQe97hTwUmf\/Pdpi7bFhXIRwoFIzPCWgQhJQa+8tnD8\/pXTppc3gDE7O4iU\/rVpUfE3srgyuH1yj+k4nzLPSq4NZLAS56OAQy5QDNZy3ggMB80K2abfcKnTKUj+PdwQHPZts\/C+4D\/36A7JegR\/W3PFaNDuAD\/46OCpKrW7LpP7FYOPu7Ozpr0eU271IuAm2x\/UNk1LeSjCkxIPdY79nBzRP0irAEvI8Msv4ZrSVdsr1t\/RpWLzas\/ZfbFbabGcS75teLMq+sTMkgUzsdhPiK4EjGPkdWegTc2U1Pza59vfo8GvjgWu6bequOAC6juCLLLVLrtXE\/adLRcKWAnGbNpZYgQ902Wzyjjsvm1fieNg3c64rQQcT8lb+Z8qJ8dP97XW7U1KrIBysmfcDJH\/fWrtiZn\/uNTBbSrSOXnoC++It3O9MYNq1LFQsIpvk1hFOtIVzBuSLGIBnzmTJ9wHo+KjHyfK419IynOJi9bdTYyqoUB3tL0NOGnPZjDdDC5s3F83lxUora\/qJFE3VTiR4xz2r+Qwo5wSYSKqgH5wzQcoH1+Bxwxvqq0RY4vRl2i37W4WjXUXzMsACeEUlciAPXVdyXX9bZ27w2EuMhuphto\/EVTw7KPKcqLMwpi2RtFzP2JyvhmJhRiLUq9InaFTk1Vsr4zIkDJGbUOTwNiobXSqcaDvh6c7N7oBz7zywhIJ75hSdCbEo+UGmFiWukIaVl2AHJg+5rXQ+xSl5gLBN56yOd9RHJFCMB7B1ErKAem\/w0283t9w1vtlpc7hGH2zTMDympgXBswQX6wmt9u1kKbK2lAwZl8Qn4\/CMt2EVygeOPnIcTL90iVGWnxq9AuExOCXU+MGB6\/5WzIv\/MLnNqhJuPtZAbLY+L\/14a+zXUDj0NN2vioS\/5Rz9on9la8lQE2ojjAjvplBS083Mi89vOsT9P8IXTWKxfFGxXmmCnx5YDLNQiyalXTkE1Ie7RzEMhTSS940O5x1htfleR7+DeCpiQkhA5xiSBTAg0jokKPSFHdCL+hmUSAnnzGgFOGc\/dDvcUJAe7bPtfllspsjTYJmjvlNYZCs4l\/uUWra\/14xorka+yJwnumtSaKWm0iLR3dCmJI7ug8rPV6MRywBVCOKaCJZMa7XnzdL97KxowF3CLLrfLHNnBrkrnVd60tri9VORydb1VnuhRuP\/neE1JRDKlazMNHk4RLkxtlUkY\/4MpkMhAaD0tP5uKVU+1UYSt1MQNDoJ5rYpmaepR9KJwfAUneEmWHbq8OPuClHRNAi1US5AFF4hdnA6ySg4XraqTSWm3LpAZQw\/m0CaIIx1yvrODT+TI06AecVEtzuxOLlTxClCtieYsD+b030tTrOs8P\/ZCUS0bwR\/4bbMERYvUXEOrdBHGCS\/6vlYkqrT5EYof6rVLV5Az5bb0Uqr62pz96MtZsssLhYQLtecn2j2c1clRHkEnIuyEkGLbK2Qov4Yec1J5YrGM85R0JCeFq9CF2Wad1xAJaTd3AJSuSngIxzzPf1uBSEgBk8PnV5l98T9I8uAVI8ICzTqKn2tcpA00xS1dLCxw5AVBaDYl9JV6lW3jdya9WpoG57ldhCfTsR3O5RTlcPGPVEhepyVOnN4muZG4+kCNuAJuB2OFerJPX4GsqwcYrTFSqFUSjWki0IQzQEUXP22KpTPsgENb7pgilkuBm3djSx\/YBj623aXSlRXDehVPP6HXExDymncFjNW2q+2s2JN0vIfc7n5vkiQe0lPj1zijyfWsb0X7pXK4gTU4+5N7RF2CzGlLvfzWfR+jiR8\/LJ1R3NFEoaJKVtynxJ\/yKujHzFJMNC70BZdEyMGSscYIjNrF4nVDI0Th8mdvPIgJP6hkED07mHq8Cjh851VwEzrCbUTNgXh4IccK6TeCc+KicexX6OeKBfGZX1+VflCwe7cfvb+OlxNdcw1naExWjHD6y\/iItjb5vVMw0322KWTStbeavi4Knj0eqGo7U2m5Nwjf+qxr3ZuTqvx91l8SssE1sG28D9GddqVKocJAnYBpJsMmhIJj0f5WXwEPOwbyd591UBRgy3K5Ltr6dM1jU2nDw\/yZjTpe4X0CADnq5TE9bGCPBU6Xh6pQqVj8UuTs08J6xELpyuLQQIP+amRYB5QcpM8miI1UtlWo2VdlAaZ5ZRUnw47i1Q4kSc0TL8zyYl6H9MidT7u8r6aIPn2mXIIg2AAHmL3r+UU\/jTzrnmy0SGUtt8sVwg+IVxm833SNvOb\/YquDHrZunGJXLfLP9yU7KIDJyKOp9x3Rjn1Sp4d+MZMPhtt6GZnUijAi1h9xvfK3o407TBBhKaDV5zIWQ2kRMTXyEG6y6PSvz2ixOy1ZrsrcBVP4g+OGQJ88HITxYrezZOeu7aSQ9UN15uz29J\/atKwEdZia6iqbcWKNXRVki0a\/MjhCAAZQGIpLdBBFNRBgQg5NXcN5yLsRanpt+6rleqJQ5JgTiRiOhCCqT9j5tFxagrEET+EsMyCkKby7gz\/jkscNXuw9zHekFMokDli2dYHTCPR+AW1lJl6wi7UuMh7yZ96jTvID\/fOEPDculCyOpGc\/BTCqyvXjgqUPyMD7rK+tZmNQH2p0yKUJCPxAKEemYkBusX9TXc4b7rHkUuR2a\/QSjQt+7cLbbXNqv3Y0lpvDI6L3ooi0zjcLh+qNTbE3nKm7RUyTGNntyzijQHu+wRVS\/8m7NFx+e2+1qFoqIsVf4t6MFwmeGgnlXJpQYdzSTlzDea5rOjcegTHVFW2O94Z+BGk:utf-8"},"name":"superuser"},{"username":"admin","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"3Gjk5tJhbxyv9G7F8oZ80D0ClqFtSQBOUmUD6EBIJXXr3dFLHU2UawI=:utf-8"},"name":"API_USER"}],"package_definition_list":[{"description":"CentOS 8 Cloud Image","action_list":[],"type":"SUBSTRATE_IMAGE","service_local_reference_list":[],"name":"CentOS_8_Cloud","version":"","options":{"type":"","name":"CentOS_8_Cloud","resources":{"image_type":"DISK_IMAGE","checksum":{"checksum_algorithm":"","type":"","checksum_value":""},"source_uri":"https:\/\/cloud.centos.org\/centos\/8\/x86_64\/images\/CentOS-8-GenericCloud-8.2.2004-20200611.2.x86_64.qcow2","version":{"product_version":"8","type":"","product_name":"CentOS"},"architecture":"X86_64","type":""},"description":""},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"WebServer"}],"name":"Package2","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package2"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Linux_OS_Update"},{"kind":"app_task","name":"Install_WebServer"},{"kind":"app_task","name":"3Tier_Webapp"}],"name":"a0484eda_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Linux_OS_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install_WebServer"}},{"from_task_reference":{"kind":"app_task","name":"Install_WebServer"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"3Tier_Webapp"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Linux_OS_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo yum -y update\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Install_WebServer","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\necho \"__ Install httpd and php...\"\r\nsudo yum install -y httpd\r\nsudo yum install -y php php-gd php-mbstring php-pdo php-mysqlnd\r\n\r\necho \"<IfModule mod_dir.c>\r\n        DirectoryIndex index.php index.html\r\n<\/IfModule>\" | sudo tee \/etc\/httpd\/conf.modules.d\/dir.conf\r\n\r\necho \"<?php\r\nphpinfo();\r\n?>\" | sudo tee \/var\/www\/html\/index.php\r\n\r\nsudo systemctl enable httpd\r\n\r\n# temporarily disable SELinux to prevent httpd to MySQL authentication issues\r\n# this is for testing only and should not be done in production environments\r\necho \"__ Temporarily disable SELinux...\"\r\nsudo setenforce 0\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"3Tier_Webapp","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\nsudo touch \/var\/www\/html\/index.php\nsudo chown @@{teccadmin.username}@@:@@{teccadmin.username}@@ \/var\/www\/html\/index.php\n\ncat > \/var\/www\/html\/index.php <<- \"EOF\"\n<html>\n<head>\n  <title>@@{calm_blueprint_name}@@<\/title>\n<\/head>\n<body>\n <h1>Hostname: @@{name}@@ at @@{address}@@, replica: @@{calm_array_index}@@<\/h1>\n<?php\ntry {\n  $dbh = new PDO('mysql:host=@@{MySQL.address}@@;dbname=@@{DATABASE_NAME}@@', '@@{MYSQL_APP_USER}@@', '@@{MYSQL_PASSWORD}@@', array(\n    PDO::ATTR_PERSISTENT => true,\n    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,\n  ));\n\n  \/\/ ensure there is at least 1 row of data for the app to read\n  $data = $dbh->query(\"INSERT INTO @@{DATABASE_TABLE}@@ (id, time, message) VALUES (NULL, CURRENT_TIMESTAMP, '@@{calm_username}@@')\");\n\n  $data = $dbh->query('SELECT MAX(id) AS count FROM @@{DATABASE_TABLE}@@')->fetchAll(PDO::FETCH_COLUMN);\n  $count = $data[0]; \/\/print_r($data);\n  $data = $dbh->query(\"SELECT time, message FROM @@{DATABASE_TABLE}@@ WHERE id = $count\")->fetchAll(PDO::FETCH_ASSOC);\n  $time = $data[0]['time'];\n  $message = $data[0]['message'];\n\n  echo \"<p>Database records: $count<\/p>\\n\";\n  echo \"<p>Last maintainer: $message, on: $time<\/p>\\n\";\n  echo \"<h3>Web docroot: {$_SERVER[\"DOCUMENT_ROOT\"]}, file: {$_SERVER[\"SCRIPT_NAME\"]}<\/h3>\\n\";\n\n  $dbh = null;\n}\ncatch (PDOException $e) {\n  print \"Error!: \" . $e->getMessage() . \"<br\/>\";\n  print phpinfo();\n  die();\n}\n?><\/body>\n<\/html>\nEOF\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"4a161ce1_runbook","main_task_local_reference":{"kind":"app_task","name":"a0484eda_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package2"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_WebServer"}],"name":"9ab78648_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_WebServer","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\nsudo rm -rf \/var\/www\/html\/* || true\r\nsudo yum erase -y httpd php || true\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"e96f5315_runbook","main_task_local_reference":{"kind":"app_task","name":"9ab78648_dag"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"HAProxy"}],"name":"Package3","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package3"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Linux_OS_Update"},{"kind":"app_task","name":"HAProxy_Install"}],"name":"4a731e9d_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Linux_OS_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"HAProxy_Install"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Linux_OS_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo yum -y update\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Install","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\necho \"__ HAProxy installation...\"\r\nsudo yum install -y haproxy &&\r\n  sudo systemctl enable haproxy || true # idempotent\r\nhaproxy -v\r\n\r\necho \"__ HAProxy configuration...\"\r\n# http:\/\/cbonte.github.io\/haproxy-dconv\/1.8\/configuration.html#4\r\nport=80\r\n\r\necho \"global\r\n  log 127.0.0.1 local0\r\n  log 127.0.0.1 local1 notice\r\n  maxconn 4096\r\n  quiet\r\n  user haproxy\r\n  group haproxy\r\ndefaults\r\n  log global\r\n  mode http\r\n  retries 3\r\n  timeout client 50s\r\n  timeout connect 5s\r\n  timeout server 50s\r\n  option dontlognull\r\n  option httplog\r\n  option redispatch\r\n  balance  roundrobin\r\n# Set up application listeners here.\r\nlisten stats\r\n  bind *:8080\r\n  mode http\r\n  log global\r\n  stats enable\r\n  stats hide-version\r\n  stats refresh 30s\r\n  stats show-node\r\n  stats uri \/stats\r\n#listen admin\r\n#  bind 127.0.0.1:22002\r\n#  mode http\r\n#  stats uri \/\r\nfrontend http\r\n  bind *:${port}\r\n  maxconn 2000\r\n  default_backend servers-http\r\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\r\n\r\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\r\n\r\nhosts=$(echo \"@@{WebServer.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\r\nfor host in $hosts; do\r\n  echo  \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\r\ndone\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"3c8b5180_runbook","main_task_local_reference":{"kind":"app_task","name":"4a731e9d_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package3"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_HAProxy"}],"name":"f61300e6_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_HAProxy","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo yum -y erase haproxy\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"0f94a6b6_runbook","main_task_local_reference":{"kind":"app_task","name":"f61300e6_dag"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"MySQL"}],"name":"MySQL_Package","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"MySQL_Package"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Linux_OS_Update"},{"kind":"app_task","name":"MySQL_Install"}],"name":"7575a53f_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Linux_OS_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"MySQL_Install"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Linux_OS_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo yum -y update\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"MySQL_Install","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\n# Assuming CentOS\/RedHat 8.2\necho \"__ Mysql installation...\"\n# https:\/\/dev.mysql.com\/doc\/refman\/8.0\/en\/linux-installation-yum-repo.html\n\nsudo yum install -y \"http:\/\/repo.mysql.com\/mysql80-community-release-el8.rpm\" &&\n  sudo yum module -y disable mysql &&\n  sudo yum install -y mysql-community-server\n\n# database must be started for SQL configuration\nsudo systemctl start mysqld\n# database should start on OS boot\nsudo systemctl enable mysqld\n# sudo systemctl status mysqld.service\n\necho \"__ Altering database root password...\"\n\nmysql --user=root --connect-expired-password \\\n  --password=\"$(sudo grep -oP 'temporary password(.*): \\K(\\S+)' \/var\/log\/mysqld.log)\" <<- EOF\n\nSET GLOBAL validate_password.policy=LOW;\nALTER user 'root'@'localhost' IDENTIFIED BY '@@{MYSQL_PASSWORD}@@';\n\nFLUSH PRIVILEGES;\nEOF\n\necho \"__ Creating database, table, and app user permissions...\"\n\nmysql --user=root --password='@@{MYSQL_PASSWORD}@@' <<- \"EOF\"\n\nCREATE DATABASE IF NOT EXISTS @@{DATABASE_NAME}@@ ;\nCREATE TABLE IF NOT EXISTS @@{DATABASE_NAME}@@.@@{DATABASE_TABLE}@@ ( \\\n  id INT NOT NULL AUTO_INCREMENT , \\\n  time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP , \\\n  message VARCHAR(80) NULL DEFAULT NULL , \\\n  PRIMARY KEY (id)) \\\n  ENGINE = InnoDB CHARSET=ascii COLLATE ascii_general_ci COMMENT = 'testing';\n\nFLUSH PRIVILEGES;\nCREATE USER '@@{MYSQL_APP_USER}@@'@'%' IDENTIFIED WITH mysql_native_password BY '@@{MYSQL_PASSWORD}@@' \\\n  REQUIRE NONE WITH MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0 MAX_USER_CONNECTIONS 0;\nGRANT SELECT, INSERT ON *.* TO '@@{MYSQL_APP_USER}@@'@'%';\n\nCREATE USER '@@{MYSQL_APP_USER}@@'@'localhost' IDENTIFIED WITH mysql_native_password BY '@@{MYSQL_PASSWORD}@@' \\\n  REQUIRE NONE WITH MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0 MAX_USER_CONNECTIONS 0;\nGRANT SELECT, INSERT ON *.* TO '@@{MYSQL_APP_USER}@@'@'localhost';\n\nFLUSH PRIVILEGES;\nEOF\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"d3b0d52b_runbook","main_task_local_reference":{"kind":"app_task","name":"7575a53f_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"MySQL_Package"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"MySQL_Uninstall"}],"name":"b5d49dd9_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"MySQL_Uninstall","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\necho \"Generic uninstall script, goodbye!\"\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"e557590f_runbook","main_task_local_reference":{"kind":"app_task","name":"b5d49dd9_dag"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"WebServer2"}],"name":"WebServer2_Package","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"WebServer2_Package"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Linux_OS_Update"},{"kind":"app_task","name":"Install_WebServer2"},{"kind":"app_task","name":"3Tier_Webapp2"}],"name":"a0484eda_dag_cloned_1","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Linux_OS_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install_WebServer2"}},{"from_task_reference":{"kind":"app_task","name":"Install_WebServer2"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"3Tier_Webapp2"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Linux_OS_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo yum -y update\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"superuser"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Install_WebServer2","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\necho \"__ Install httpd and php...\"\r\nsudo yum install -y httpd\r\nsudo yum install -y php php-gd php-mbstring php-pdo php-mysqlnd\r\n\r\necho \"<IfModule mod_dir.c>\r\n        DirectoryIndex index.php index.html\r\n<\/IfModule>\" | sudo tee \/etc\/httpd\/conf.modules.d\/dir.conf\r\n\r\necho \"<?php\r\nphpinfo();\r\n?>\" | sudo tee \/var\/www\/html\/index.php\r\n\r\nsudo systemctl enable httpd\r\n\r\n# temporarily disable SELinux to prevent httpd to MySQL authentication issues\r\n# this is for testing only and should not be done in production environments\r\necho \"__ Temporarily disable SELinux...\"\r\nsudo setenforce 0\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"superuser"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"3Tier_Webapp2","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\nsudo touch \/var\/www\/html\/index.php\nsudo chown @@{superuser.username}@@:@@{superuser.username}@@ \/var\/www\/html\/index.php\n\ncat > \/var\/www\/html\/index.php <<- \"EOF\"\n<html>\n<head>\n  <title>@@{calm_blueprint_name}@@<\/title>\n<\/head>\n<body>\n <h1>Hostname: @@{name}@@ at @@{address}@@, replica: @@{calm_array_index}@@<\/h1>\n<?php\ntry {\n  $dbh = new PDO('mysql:host=@@{MySQL.address}@@;dbname=@@{DATABASE_NAME}@@', '@@{MYSQL_APP_USER}@@', '@@{MYSQL_PASSWORD}@@', array(\n    PDO::ATTR_PERSISTENT => true,\n    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,\n  ));\n\n  \/\/ ensure there is at least 1 row of data for the app to read\n  $data = $dbh->query(\"INSERT INTO @@{DATABASE_TABLE}@@ (id, time, message) VALUES (NULL, CURRENT_TIMESTAMP, '@@{calm_username}@@')\");\n\n  $data = $dbh->query('SELECT MAX(id) AS count FROM @@{DATABASE_TABLE}@@')->fetchAll(PDO::FETCH_COLUMN);\n  $count = $data[0]; \/\/print_r($data);\n  $data = $dbh->query(\"SELECT time, message FROM @@{DATABASE_TABLE}@@ WHERE id = $count\")->fetchAll(PDO::FETCH_ASSOC);\n  $time = $data[0]['time'];\n  $message = $data[0]['message'];\n\n  echo \"<p>Database records: $count<\/p>\\n\";\n  echo \"<p>Last maintainer: $message, on: $time<\/p>\\n\";\n  echo \"<h3>Web docroot: {$_SERVER[\"DOCUMENT_ROOT\"]}, file: {$_SERVER[\"SCRIPT_NAME\"]}<\/h3>\\n\";\n\n  $dbh = null;\n}\ncatch (PDOException $e) {\n  print \"Error!: \" . $e->getMessage() . \"<br\/>\";\n  print phpinfo();\n  die();\n}\n?><\/body>\n<\/html>\nEOF\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"superuser"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"4a161ce1_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"a0484eda_dag_cloned_1"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"WebServer2_Package"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_WebServer2"}],"name":"9ab78648_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_WebServer2","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\nsudo rm -rf \/var\/www\/html\/* || true\r\nsudo yum erase -y httpd php || true\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"e96f5315_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"9ab78648_dag_cloned_1"},"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"8d7a5c0b_deployment","min_replicas":"2","default_replicas":"2","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"4","package_local_reference_list":[{"kind":"app_package","name":"Package2"}],"substrate_local_reference":{"kind":"app_substrate","name":"WebServerAHV"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"4e46245a_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"Package3"}],"substrate_local_reference":{"kind":"app_substrate","name":"HAProxyAHV"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"03185f76_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"MySQL_Package"}],"substrate_local_reference":{"kind":"app_substrate","name":"MySQLAWS"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"e429b102_deployment","min_replicas":"2","default_replicas":"2","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"4","package_local_reference_list":[{"kind":"app_package","name":"WebServer2_Package"}],"substrate_local_reference":{"kind":"app_substrate","name":"WebServerAWS"},"variable_list":[],"description":""}],"description":"","action_list":[{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"ScaleOut"},{"kind":"app_task","name":"HAProxy_Update"},{"kind":"app_task","name":"Restart"}],"name":"f64e8214_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"HAProxy_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Restart"}},{"from_task_reference":{"kind":"app_task","name":"ScaleOut"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"HAProxy_Update"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"8d7a5c0b_deployment"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ScaleOut","attrs":{"scaling_count":"1","type":"","scaling_type":"SCALEOUT"},"timeout_secs":"0","type":"SCALING","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\necho \"__ HAProxy installation...\"\r\nsudo yum install -y haproxy &&\r\n  sudo systemctl enable haproxy || true # idempotent\r\nhaproxy -v\r\n\r\necho \"__ HAProxy configuration...\"\r\n# http:\/\/cbonte.github.io\/haproxy-dconv\/1.8\/configuration.html#4\r\nport=80\r\n\r\necho \"global\r\n  log 127.0.0.1 local0\r\n  log 127.0.0.1 local1 notice\r\n  maxconn 4096\r\n  quiet\r\n  user haproxy\r\n  group haproxy\r\ndefaults\r\n  log global\r\n  mode http\r\n  retries 3\r\n  timeout client 50s\r\n  timeout connect 5s\r\n  timeout server 50s\r\n  option dontlognull\r\n  option httplog\r\n  option redispatch\r\n  balance  roundrobin\r\n# Set up application listeners here.\r\nlisten stats\r\n  bind *:8080\r\n  mode http\r\n  log global\r\n  stats enable\r\n  stats hide-version\r\n  stats refresh 30s\r\n  stats show-node\r\n  stats uri \/stats\r\n#listen admin\r\n#  bind 127.0.0.1:22002\r\n#  mode http\r\n#  stats uri \/\r\nfrontend http\r\n  bind *:${port}\r\n  maxconn 2000\r\n  default_backend servers-http\r\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\r\n\r\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\r\n\r\nhosts=$(echo \"@@{WebServer.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\r\nfor host in $hosts; do\r\n  echo  \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\r\ndone\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"a5b1f46f_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"70ad38ee_runbook","main_task_local_reference":{"kind":"app_task","name":"f64e8214_dag"},"variable_list":[]},"name":"WebScaleOut"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"HAProxy_Update"},{"kind":"app_task","name":"Restart"},{"kind":"app_task","name":"ScaleIn"}],"name":"9ce9e4c3_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"HAProxy_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Restart"}},{"from_task_reference":{"kind":"app_task","name":"Restart"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"ScaleIn"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\necho \"__ HAProxy installation...\"\r\nsudo yum install -y haproxy &&\r\n  sudo systemctl enable haproxy || true # idempotent\r\nhaproxy -v\r\n\r\necho \"__ HAProxy configuration...\"\r\n# http:\/\/cbonte.github.io\/haproxy-dconv\/1.8\/configuration.html#4\r\nport=80\r\n\r\necho \"global\r\n  log 127.0.0.1 local0\r\n  log 127.0.0.1 local1 notice\r\n  maxconn 4096\r\n  quiet\r\n  user haproxy\r\n  group haproxy\r\ndefaults\r\n  log global\r\n  mode http\r\n  retries 3\r\n  timeout client 50s\r\n  timeout connect 5s\r\n  timeout server 50s\r\n  option dontlognull\r\n  option httplog\r\n  option redispatch\r\n  balance  roundrobin\r\n# Set up application listeners here.\r\nlisten stats\r\n  bind *:8080\r\n  mode http\r\n  log global\r\n  stats enable\r\n  stats hide-version\r\n  stats refresh 30s\r\n  stats show-node\r\n  stats uri \/stats\r\n#listen admin\r\n#  bind 127.0.0.1:22002\r\n#  mode http\r\n#  stats uri \/\r\nfrontend http\r\n  bind *:${port}\r\n  maxconn 2000\r\n  default_backend servers-http\r\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\r\n\r\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\r\n\r\nhosts=$(echo \"@@{WebServer.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\r\nfor host in $hosts; do\r\n  echo  \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\r\ndone\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"a5b1f46f_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"8d7a5c0b_deployment"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ScaleIn","attrs":{"scaling_count":"1","type":"","scaling_type":"SCALEIN"},"timeout_secs":"0","type":"SCALING","variable_list":[]}],"description":"","name":"aaf64601_runbook","main_task_local_reference":{"kind":"app_task","name":"9ce9e4c3_dag"},"variable_list":[]},"name":"WebScaleIn"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"DatabaseBackup"}],"name":"ba8861e3_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"DatabaseBackup","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\nmysqldump --all-databases --user=root --password='@@{MYSQL_PASSWORD}@@'\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"7d84192b_runbook","main_task_local_reference":{"kind":"app_task","name":"ba8861e3_dag"},"variable_list":[]},"name":"DatabaseBackup"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"ScaleOut2"},{"kind":"app_task","name":"HAProxy_Update"},{"kind":"app_task","name":"Restart"}],"name":"6c8d2d3d_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"HAProxy_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Restart"}},{"from_task_reference":{"kind":"app_task","name":"ScaleOut2"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"HAProxy_Update"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"e429b102_deployment"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ScaleOut2","attrs":{"scaling_count":"1","type":"","scaling_type":"SCALEOUT"},"timeout_secs":"0","type":"SCALING","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\necho \"__ HAProxy installation...\"\nsudo yum install -y haproxy &&\n  sudo systemctl enable haproxy || true # idempotent\nhaproxy -v\n\necho \"__ HAProxy configuration...\"\n# http:\/\/cbonte.github.io\/haproxy-dconv\/1.8\/configuration.html#4\nport=80\n\necho \"global\n  log 127.0.0.1 local0\n  log 127.0.0.1 local1 notice\n  maxconn 4096\n  quiet\n  user haproxy\n  group haproxy\ndefaults\n  log global\n  mode http\n  retries 3\n  timeout client 50s\n  timeout connect 5s\n  timeout server 50s\n  option dontlognull\n  option httplog\n  option redispatch\n  balance  roundrobin\n# Set up application listeners here.\nlisten stats\n  bind *:8080\n  mode http\n  log global\n  stats enable\n  stats hide-version\n  stats refresh 30s\n  stats show-node\n  stats uri \/stats\n#listen admin\n#  bind 127.0.0.1:22002\n#  mode http\n#  stats uri \/\nfrontend http\n  bind *:${port}\n  maxconn 2000\n  default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{WebServer.address}@@,@@{WebServer2.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\nfor host in $hosts; do\n  echo  \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"a5b1f46f_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"00a11df3_runbook","main_task_local_reference":{"kind":"app_task","name":"6c8d2d3d_dag"},"variable_list":[]},"name":"AWSScaleOut"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"HAProxy_Update"},{"kind":"app_task","name":"Restart"},{"kind":"app_task","name":"ScaleIn2"}],"name":"bf5b779b_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"HAProxy_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Restart"}},{"from_task_reference":{"kind":"app_task","name":"Restart"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"ScaleIn2"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\necho \"__ HAProxy installation...\"\nsudo yum install -y haproxy &&\n  sudo systemctl enable haproxy || true # idempotent\nhaproxy -v\n\necho \"__ HAProxy configuration...\"\n# http:\/\/cbonte.github.io\/haproxy-dconv\/1.8\/configuration.html#4\nport=80\n\necho \"global\n  log 127.0.0.1 local0\n  log 127.0.0.1 local1 notice\n  maxconn 4096\n  quiet\n  user haproxy\n  group haproxy\ndefaults\n  log global\n  mode http\n  retries 3\n  timeout client 50s\n  timeout connect 5s\n  timeout server 50s\n  option dontlognull\n  option httplog\n  option redispatch\n  balance  roundrobin\n# Set up application listeners here.\nlisten stats\n  bind *:8080\n  mode http\n  log global\n  stats enable\n  stats hide-version\n  stats refresh 30s\n  stats show-node\n  stats uri \/stats\n#listen admin\n#  bind 127.0.0.1:22002\n#  mode http\n#  stats uri \/\nfrontend http\n  bind *:${port}\n  maxconn 2000\n  default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{WebServer.address}@@,@@{WebServer2.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\nfor host in $hosts; do\n  echo  \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"a5b1f46f_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"e429b102_deployment"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ScaleIn2","attrs":{"scaling_count":"1","type":"","scaling_type":"SCALEIN"},"timeout_secs":"0","type":"SCALING","variable_list":[]}],"description":"","name":"ffce4d82_runbook","main_task_local_reference":{"kind":"app_task","name":"bf5b779b_dag"},"variable_list":[]},"name":"AWSScaleIn"}],"name":"AWS_Nutanix_Hybrid","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"USER_INITIALS","value":"yrsl","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"MYSQL_APP_USER","value":"webapp_user","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"regex":{"should_validate":false,"value":""},"val_type":"STRING","is_mandatory":true,"description":"MySQL low password security requirements are 8 or more characters with at least 1 uppercase character","data_type":"BASE","type":"SECRET","name":"MYSQL_PASSWORD","value":"cnftDi3fK\/WZYnYi2MhFU9EwNrr6QyQ92cITT0sNEKI+HgwloF5dAgBN:utf-8","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":"SECRET"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DATABASE_NAME","value":"webapp","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DATABASE_TABLE","value":"tecc_dba_test","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"regex":{"should_validate":false,"value":"^[\\d]*$"},"val_type":"INT","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"VLAN_ID","value":"999","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"regex":{"should_validate":false,"value":"^.*$"},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"VLAN_NAME","value":"999","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"superuser"},"type":"USER"},"name":"Production-3Tier-Application_v6"},"api_version":"3.0","metadata":{"last_update_time":"1607459666509081","kind":"blueprint","spec_version":11,"creation_time":"1607458941010526","name":"Production-3Tier-Application_v6"}}